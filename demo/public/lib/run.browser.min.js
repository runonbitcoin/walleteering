/*! For license information please see run.browser.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("bsv")):"function"==typeof define&&define.amd?define(["bsv"],e):"object"==typeof exports?exports.Run=e(require("bsv")):t.Run=e(t.bsv)}(window,(function(__WEBPACK_EXTERNAL_MODULE__2__){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=16)}([function(t,e,r){const n=r(2),{Jig,JigControl}=r(3),{Berry}=r(10),StandardLock=r(18);function o(t){return"function"==typeof t&&-1===t.toString().indexOf("[native code]")}function i(t){return JigControl.g(()=>{if(t)return t instanceof Jig?"jig":t instanceof Berry?"berry":o(t)?"code":void 0})}function s(t){return JigControl.g(()=>{switch(typeof t){case"string":return`"${t.length>20?t.slice(0,20)+"â€¦":t}"`;case"object":return t?t.constructor.name?`[object ${t.constructor.name}]`:"[anonymous object]":"null";case"function":{const e=t.toString();return/^\(/.test(e)||/^function\s*\(/.test(e)||/^[a-zA-Z0-9_$]+\s*=>/.test(e)?"[anonymous function]":/^class\s*{/.test(e)?"[anonymous class]":t.name}case"undefined":return"undefined";default:return t.toString()}})}function c(t,e,n=new Set){"function"!=typeof t&&"object"!=typeof t||!t||function(t,e,n){if(n.has(t))return;n.add(t);const o=t=>{"function"!=typeof t&&"object"!=typeof t||!t||e(t)&&c(t,e,n)},i=r(4)._;if(t instanceof i.P.Set||t instanceof i.O.Set)for(const e of t)o(e);if(t instanceof i.P.Map||t instanceof i.O.Map)for(const[e,r]of t)o(e),o(r);Object.keys(t).forEach(e=>o(t[e]))}(t,e,n)}t.exports={A:function(){const t=r(16);if(!t.instance)throw new Error("Run not instantiated");return t.instance},I:function(t){return t.startsWith("main")?"mainnet":"testnet"},j:function(t){switch(t){case"main":return"Mainnet";case"test":return"Testnet";case"stn":return"Stn";case"mock":return"Mocknet";default:throw new Error("Unknown network: "+t)}},$:o,k:i,R:function(t,e){return t===e||t.origin&&"_"!==t.origin[0]&&t.origin===e.origin},F:s,M:function(t){const e=t.toString(),r=Object.getPrototypeOf(t);if(r.prototype){const n=/^class \S+ extends \S+ {/;return e.replace(n,`class ${t.name} extends ${r.name} {`)}const n=e.match(/^([a-zA-Z0-9_$]+)\S*\(/);return n&&"function"!==n[1]?"function "+e:e},U:function(t,e){c([t],t=>!i(t)&&(JigControl.N(()=>{if(void 0!==t.$owner&&t.$owner!==e){const e="Hint: Consider storing a clone of the value instead.";throw new Error(`${s(t)} belongs to a different resource\n\n${e}`)}}),!0))},C:c,B:function(t,e,n=new Set){"function"!=typeof t&&"object"!=typeof t||!t||function t(e,n,o){if(!e)return;if(o.has(e))return;o.add(e);const i=e=>{if("function"!=typeof e&&"object"!=typeof e||!e)return e;const r=n(e);return t(r,n,o),r},s=r(4)._,c=s.O,a=s.P;if(e instanceof c.Set||e instanceof a.Set){const t=[],r=[];for(const n of e){const o=i(n);o!==n&&(t.push(n),r.push(o)),t.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t))}}if(e instanceof c.Map||e instanceof a.Map){const t=[],r=[];for(const[n,o]of e){const e=i(n),s=i(o);e!==n&&t.push(n),e===n&&s===o||r.push([e,s])}t.forEach(t=>{e.delete(t)}),r.forEach(([t,r])=>e.set(t,r))}Object.keys(e).forEach(t=>{e[t]=i(e[t])})}(t,e,n)},D:function(t){if("number"!=typeof t)throw new Error("satoshis must be a number");if(!Number.isInteger(t))throw new Error("satoshis must be an integer");if(isNaN(t)||!isFinite(t))throw new Error("satoshis must be finite");if(t<0)throw new Error("satoshis must be non-negative");if(t>1e8)throw new Error("satoshis must be <= 100000000")},L:function(t,e){if("string"==typeof t){try{const r=new n.PublicKey(t,{network:e});return new StandardLock(r.toAddress().toString())}catch(t){}try{return new n.Address(t,e),new StandardLock(t)}catch(t){}}if("object"==typeof t&&t){const e=t.script,n=r(4),o=n._.P,i=n._.O;if(e instanceof o.Uint8Array||e instanceof i.Uint8Array)return t}throw new Error("Invalid owner: "+s(t))},G:class{constructor(){this.tasks=[]}async enqueue(t){return new Promise((e,r)=>{this.tasks.push({func:t,reject:r,resolve:e}),1===this.tasks.length&&this.execNext()})}async execNext(){const t=this.tasks[0];try{const e=t.func();t.resolve(e instanceof Promise?await e:e)}catch(e){t.reject(e)}finally{this.tasks.shift(),this.tasks.length&&this.execNext()}}},J:function(t,e){const r=new n.Transaction(t),o=r.toObject(),i=[],s=[];r.inputs&&r.inputs.forEach((function(t,r){if(t.script){const o={i:r,seq:t.sequenceNumber};t.script.chunks.forEach((function(t,r){t.buf?(t.buf.byteLength>=1e6?o["xlb"+r]=t.buf.toString("base64"):t.buf.byteLength>=512&&t.buf.byteLength<1e6?o["lb"+r]=t.buf.toString("base64"):o["b"+r]=t.buf.toString("base64"),e&&e.h&&e.h>0&&(o["h"+r]=t.buf.toString("hex"))):void 0!==t.opcodenum?o["b"+r]={op:t.opcodenum}:o["b"+r]=t}));const s={h:t.prevTxId.toString("hex"),i:t.outputIndex},c=t.script.toAddress(n.Networks.livenet).toString();c&&c.length>0&&(s.a=c),o.e=s,i.push(o)}})),r.outputs&&r.outputs.forEach((function(t,r){if(t.script){const o={i:r};t.script.chunks.forEach((function(t,r){t.buf?(t.buf.byteLength>=1e6?(o["xlb"+r]=t.buf.toString("base64"),o["xls"+r]=t.buf.toString("utf8")):t.buf.byteLength>=512&&t.buf.byteLength<1e6?(o["lb"+r]=t.buf.toString("base64"),o["ls"+r]=t.buf.toString("utf8")):(o["b"+r]=t.buf.toString("base64"),o["s"+r]=t.buf.toString("utf8")),e&&e.h&&e.h>0&&(o["h"+r]=t.buf.toString("hex"))):void 0!==t.opcodenum?o["b"+r]={op:t.opcodenum}:o["b"+r]=t}));const i={v:t.satoshis,i:r},c=t.script.toAddress(n.Networks.livenet).toString();c&&c.length>0&&(i.a=c),o.e=i,s.push(o)}}));const c={tx:{h:o.hash},in:i,out:s,lock:o.nLockTime};return e&&e.confirmations&&(c.confirmations=e.confirmations),c},H:function(t){const e=r(5),n=r(4),o=[],i={W:n._.P,K:e.q.V(e.q.Y(t=>(o.push(t),o.length-1)),e.q.Z()),X:e.tt.V(e.tt.Y(t=>o[t]),e.tt.Z())},s=e.et(t,i);return e.rt(s,i)},nt:function(t){const e=r(5),n=r(4),o=[],i={W:n._.ot,K:e.q.V(e.q.Y(t=>(o.push(t),o.length-1)),e.q.Z()),X:e.tt.V(e.tt.Y(t=>o[t]),e.tt.Z())},s=e.et(t,i);return e.rt(s,i)}}},function(t,e){const r={};function n(t,e,...n){r.it&&r.it[t]&&"function"==typeof r.it[t]&&r.it[t]((new Date).toISOString(),`[${e}]`,...n)}r.st={warn:console.warn,error:console.error},r.it=r.st,r.ct=(...t)=>n("info",...t),r.at=(...t)=>n("warn",...t),r.ut=(...t)=>n("error",...t),r.ft=(...t)=>n("debug",...t),t.exports=r},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__2__},function(t,e,r){const Context=r(17);class Jig{constructor(...t){const e=Context.A();if(!e.code.isSandboxed(this.constructor)){e.transaction.begin();try{return new(e.code.deploy(this.constructor))(...t)}finally{e.transaction.end()}}const r=[];let n=this.constructor;for(;n!==Jig;)r.push(n),n=Object.getPrototypeOf(n);if(0===r.length)throw new Error("Jig must be extended");const o=/\s+constructor\s*\(/;if(r.some(t=>o.test(t.toString())))throw new Error("Jig must use init() instead of constructor()");const i=["origin","location","owner","satoshis","sync"];r.forEach(t=>{i.forEach(t=>{if(Object.prototype.hasOwnProperty.call(r[0].prototype,t))throw new Error("must not override "+t)})});const s=[];[...r,Jig].forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(t=>s.push(t))});const c=[...s,"owner","satoshis","origin","location"];function a(){JigControl.ht=[],JigControl.lt=new Set,JigControl.pt=new Set,JigControl.yt=new Map,JigControl.gt=new Map,JigControl.dt=new Map,JigControl.ut=null}const u=()=>{if(JigControl.wt&&this.origin&&"!"===this.origin[0])throw new Error(""+this.origin.slice(1))},f=this,h={bt:f,_t:null,Pt:null},l=new Proxy(this,h),p=()=>JigControl.ht[JigControl.ht.length-1],y=()=>JigControl.ht.length&&p()===f,g=()=>JigControl.ht.length&&p().constructor!==l.constructor;let d=!!JigControl.vt;return h.getPrototypeOf=function(t){return u(),JigControl.ht.length&&JigControl.dt.set(f,l),Object.getPrototypeOf(t)},h.setPrototypeOf=function(t,e){throw new Error("setPrototypeOf disallowed")},h.isExtensible=function(t){return!0},h.preventExtensions=function(t){throw new Error("preventExtensions disallowed")},h.getOwnPropertyDescriptor=function(t,e){if(u(),JigControl.ht.length&&JigControl.dt.set(f,l),!this.has(t,e))return;const r=Object.getOwnPropertyDescriptor(t,e);return r?Object.assign({},r,{value:this.get(t,e)}):void 0},h.defineProperty=function(t,e,r){throw new Error("defineProperty disallowed")},h.has=function(t,e){if(u(),JigControl.ht.length&&JigControl.dt.set(f,l),JigControl.wt&&"_"===e[0]&&g())throw new Error(`cannot check ${e} because it is private`);return JigControl.ht.length&&(!(t instanceof Jig)||!c.includes(e))&&JigControl.pt.add(f),e in t},h.get=function(t,e,r){if(u(),JigControl.ht.length&&JigControl.dt.set(f,l),JigControl.Et){if("$owner"===e)return l;if("$target"===e)return t}const n=t instanceof Jig;if(JigControl.wt&&n&&["origin","location"].includes(e)&&"_"===t[e][0])throw new Error("sync() required before reading "+e);if(n&&["origin","constructor"].includes(e))return t[e];const o=n&&"function"==typeof t[e];if(JigControl.ht.length&&!o&&JigControl.pt.add(f),"_"===e[0]&&g())throw new Error(`cannot get ${e} because it is private`);if(["undefined","boolean","number","string","symbol"].includes(typeof t[e]))return t[e];if(e===Symbol.iterator)return t instanceof Context.O.Uint8Array?t[e].bind(t):t[e].bind(r);if("object"==typeof t[e]){if(null===t[e])return null;if(Context.k(t[e]))return t[e];if(!JigControl.wt)return t[e];const r=JigControl.ht.length?t[e]:Context.H(t[e]);if("owner"===e&&n)return JigControl.ht.length&&!y()?Context.nt(t[e]):r;const o=JigControl.ht.length?this.bt:r,i=Object.assign({},this,{bt:o,_t:t,Pt:e});return JigControl.Ot?new Proxy(r,i):r}if("constructor"===e)return t[e];if("function"==typeof t[e]){const r={_t:t,Pt:e},n=Object.assign({},this,r);return JigControl.Ot?t[e].location?t[e]:new Proxy(t[e],n):t[e]}},h.set=function(t,e,r,n){if(u(),JigControl.ht.length&&JigControl.dt.set(f,l),JigControl.wt){if(!y())throw new Error(`must not set ${e} outside of a method`);if(t instanceof Jig){if(["origin","location",...s].includes(e))throw new Error("must not set "+e)}else{if("function"==typeof t[e])throw new Error("must not overwrite internal method "+e);if("function"==typeof t)throw new Error(`must not set ${e} on method ${t.name}`)}}return Context.U(r,l),t[e]=r,!0},h.deleteProperty=function(t,e){if(u(),JigControl.ht.length&&JigControl.dt.set(f,l),JigControl.wt){if(!y())throw new Error(`must not delete ${e} outside of a method`);if(t instanceof Jig){if(["origin","location","satoshis","owner",...s].includes(e))throw new Error("must not delete "+e)}else if("function"==typeof t[e])throw new Error("must not delete internal method "+e)}return delete t[e],!0},h.ownKeys=function(t){return u(),JigControl.ht.length&&JigControl.dt.set(f,l),JigControl.ht.length&&JigControl.pt.add(f),g()?Reflect.ownKeys(t).filter(t=>"_"!==t[0]):Reflect.ownKeys(t)},h.apply=function(t,e,r){const n=this._t instanceof Jig;if(n&&"_"===this.Pt[0]&&(!JigControl.ht.length||p().constructor!==l.constructor))throw new Error(`cannot call ${this.Pt} because it is private`);if(n&&"sync"===this.Pt){if(JigControl.ht.length)throw new Error("sync may only be called externally");return t.call(l,...r)}const o=Context.A();o.transaction.begin();let i=null;n||y()||(i=Object.assign({},JigControl),a());const s=JigControl.gt.get(f)||new Set;JigControl.ht.forEach(t=>s.add(t)),JigControl.gt.set(f,s),JigControl.ht.push(f),JigControl.dt.set(f,l);try{if(n&&"init"===this.Pt){if(d)throw new Error("init cannot be called twice");d=!0,JigControl.lt.add(f)}const e=new Set(JigControl.pt),s=n?new Context.Checkpoint(r,o.code):null;if(!JigControl.yt.has(this.bt)){const t=new Context.Checkpoint(Object.assign({},this.bt),o.code);JigControl.yt.set(this.bt,t)}JigControl.pt=e;const c=n?s.restore():r,u=t.call(n?l:this._t,...c);if(n&&"init"===this.Pt&&void 0!==u)throw new Error("init must not return");if(n&&(Context.L(f.owner),Context.D(f.satoshis)),JigControl.ut)throw new Error("internal errors must not be swallowed\n\n"+JigControl.ut);if(JigControl.ht.pop(),!JigControl.ht.length){const t=new Set(JigControl.pt),e=new Map,s=JigControl.g(()=>{const t=new Set(JigControl.pt);Array.from(JigControl.yt.keys()).forEach(e=>t.add(e)),t.forEach(t=>{e.set(t,new Context.Checkpoint(Object.assign({},t),o.code))});return Array.from(JigControl.yt).filter(([t,r])=>!r.equals(e.get(t))).map(([t])=>t)});JigControl.pt=t;const c=!n&&!JigControl.wt;if((JigControl.lt.size||s.length)&&!c){if(!n)throw new Error(`internal method ${this.Pt} may not be called to change state`);const t=new Set,i=new Set,c=new Set(JigControl.pt),a=e=>{i.add(e),JigControl.lt.has(e)||t.add(e)};s.forEach(t=>{JigControl.gt.get(t).forEach(t=>a(t)),a(t)}),JigControl.lt.forEach(t=>{JigControl.gt.get(t).forEach(t=>a(t)),a(t)}),o.transaction.St(f,this.Pt,r,t,i,c,JigControl.yt,e,JigControl.dt)}i?(JigControl.lt.forEach(t=>i.lt.add(t)),JigControl.pt.forEach(t=>i.pt.add(t)),JigControl.yt.forEach((t,e)=>{JigControl.yt.has(e)||i.yt.set(e,t)}),JigControl.dt.forEach((t,e)=>{JigControl.dt.has(e)||i.dt.set(e,t)}),JigControl.gt.forEach((t,e)=>{if(i.gt.has(e)){const r=i.gt.get(e);t.forEach(t=>r.add(t))}else i.gt.set(e,t)}),Object.assign(JigControl,i)):a()}o.transaction.end();try{return JigControl.ht.length?u:Context.H(u)}catch(t){return u}}catch(t){throw JigControl.ut||(JigControl.ut=t),i&&Object.assign(JigControl,i),JigControl.ht.pop(),JigControl.ht.length||(JigControl.yt.forEach((t,e)=>{const r=t.restore();JigControl.g(()=>{Object.keys(e).forEach(t=>delete e[t]),Object.assign(e,r)})}),a()),o.transaction.end(),t}},JigControl.vt||(this.owner=JigControl.ht.length?JigControl.ht[JigControl.ht.length-1].owner:Context.At(),this.satoshis=0,this.origin="_",this.location="_",l.init(...t)),l}init(){}toString(){return`[jig ${this.constructor.name}]`}async sync(t={}){return Context.A().It.Tt.xt(this,t.forward)}static[Symbol.hasInstance](t){const e=Context.A();if("object"!=typeof t)return!1;if(t===t.constructor.prototype)return!1;let r=e.code.jt(this);if(!r){const t=Context.j(e.blockchain.network);if(r=e.code.jt(this["origin"+t]),!r)return!1}let n=Object.getPrototypeOf(t);for(;n;){if(n===r.prototype)return!0;n=Object.getPrototypeOf(n)}return!1}}const JigControl={ht:[],lt:new Set,pt:new Set,yt:new Map,gt:new Map,ut:null,wt:!0,Ot:!0,Et:!1,dt:new Map,vt:!1,$t:t=>{const e=JigControl.Ot;try{return JigControl.Ot=!1,t()}finally{JigControl.Ot=e}},g:t=>{const e=JigControl.wt;try{return JigControl.wt=!1,t()}finally{JigControl.wt=e}},N:t=>{const e=JigControl.Et;try{return JigControl.Et=!0,t()}finally{JigControl.Et=e}},kt:()=>JigControl.ht.length<2?null:JigControl.dt.get(JigControl.ht[JigControl.ht.length-2])},n={JigControl,Context,Set,Map};t.exports={Jig,JigControl,Rt:n}},function(module,exports,__webpack_require__){(function(global){const DeterministicRealm=__webpack_require__(30),{ResourceMap,ResourceSet}=__webpack_require__(7),{F:_display,M:_sourceCode}=__webpack_require__(0),Log=__webpack_require__(1),TAG="Sandbox";let instance=null;class Sandbox{static get _(){return instance||(instance=new Sandbox),instance}constructor(){Log.ct(TAG,"Creating deterministic realm"),this.Ft=new DeterministicRealm;const compartment=this.Ft.makeCompartment();this.O=compartment.evaluate(_getIntrinsicsSrc),this.O.Map=this.Mt(ResourceMap,ResourceMap.deps)[0],this.O.Set=this.Mt(ResourceSet,ResourceSet.deps)[0],this.P=eval(_getIntrinsicsSrc)}Mt(t,e){if(Sandbox.excludes.includes(t)){return Log.ct(TAG,"Excluding",_display(t)),[t,void 0!==global?global:window]}return this.Ut(_sourceCode(t),e)}Ut(t,e={}){Log.ct(TAG,"Evaluating",_display(t.replace(/\s+/g," ")));const r=this.Ft.makeCompartment();Object.assign(r.global,this.O,e);const n=t.startsWith("class")?"AnonymousClass":"anonymousFunction",o=`const ${n}=${t};${n}`;return"Math"in e||Object.defineProperty(r.global,"Math",{get:()=>{throw new ReferenceError("Math is not defined\n\nHint: Math is disabled because it is non-deterministic.")}}),"Date"in e||Object.defineProperty(r.global,"Date",{get:()=>{throw new ReferenceError("Date is not defined\n\nHint: Date is disabled because it is non-deterministic.")}}),[r.evaluate(o),r.global]}}const _intrinsicNames=["console","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","Object","Function","Boolean","Symbol","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","Number","BigInt","Math","Date","String","RegExp","Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Map","Set","WeakMap","WeakSet","ArrayBuffer","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"];let _getIntrinsicsSrc="const x = {}\n";_intrinsicNames.forEach(t=>{_getIntrinsicsSrc+=`x.${t} = typeof ${t} !== 'undefined' ? ${t} : undefined\n`}),_getIntrinsicsSrc+="x",Sandbox.excludes=[],module.exports=Sandbox}).call(this,__webpack_require__(13))},function(t,e,r){(function(e){const{k:n,F:o}=r(0),{ResourceMap,ResourceSet:i}=r(7),s=r(4);class c{static et(t,e={}){(e=Object.assign({},e)).P=e.P||s._.P,e.ot=e.ot||s._.O,e.W=e.W||e.P,e.K=e.K||null,e.Nt||(e.Nt=new Set,Object.keys(e.P).forEach(t=>e.Nt.add(e.P[t])),e.P!==e.ot&&Object.keys(e.ot).forEach(t=>e.Nt.add(e.ot[t]))),e.Ct=e.Ct||new ResourceMap,e.Bt=e.Bt||new i;const r="boolean"!=typeof e.Dt||e.Dt;e.Dt=!1;const n=a(t,e);return e.Bt.size&&r?function(t,e){const r=h(e);r.$dedup={};const n=new Map;r.dups=l(e);for(const t of e.Bt){const o=h(e);o.$dup=r.dups.length,n.set(t,o),r.dups.push(t)}return r.$dedup=u(t,n),r.dups.forEach(t=>{Object.keys(t).forEach(e=>{t[e]=u(t[e],n)})}),r}(n,e):n}static rt(t,e={}){return(e=Object.assign({},e)).P=e.P||s._.P,e.ot=e.ot||s._.O,e.W=e.W||e.ot,e.X=e.X||null,f(t,e)}}function a(t,r){switch(typeof t){case"undefined":{const t=h(r);return t.$undef=1,t}case"string":case"boolean":return t;case"number":if(isNaN(t)||!isFinite(t)||Object.is(t,-0)){const e=h(r);return isNaN(t)&&(e.$nan=1),t===1/0&&(e.$inf=1),t===-1/0&&(e.$ninf=1),Object.is(t,-0)&&(e.$n0=1),e}return t;case"symbol":break;case"object":case"function":{if(!t)return null;const n=r.Ct.get(t);return n?(r.Bt.add(n),n):function(t,r){r.Nt.has(t)&&g(t);if(b(t)){const e=h(r);r.Ct.set(t,e);let n=!1;if(Object.keys(t).forEach(o=>{n=n||o.startsWith("$"),e[o]=a(t[o],r)}),!n)return e;const o=h(r);return o.$obj=e,o}if(_(t)){const e=Object.keys(t);if(e.length===t.length){const n=l(r);return r.Ct.set(t,n),e.forEach(e=>n.push(a(t[e],r))),n}{const n=h(r),o=h(r);return r.Ct.set(t,n),e.forEach(e=>{o[e]=a(t[e],r)}),n.$arr=o,n}}if((t instanceof r.P.Set||t instanceof r.ot.Set)&&3===w(t)){const e=h(r);r.Ct.set(t,e),e.$set=l(r);for(const n of t)e.$set.push(a(n,r));return Object.keys(t).length&&(e.props=h(r),Object.keys(t).forEach(n=>{e.props[n]=a(t[n],r)})),e}if((t instanceof r.P.Map||t instanceof r.ot.Map)&&3===w(t)){const e=h(r);r.Ct.set(t,e),e.$map=l(r);for(const[n,o]of t){const t=l(r);t.push(a(n,r)),t.push(a(o,r)),e.$map.push(t)}return Object.keys(t).length&&(e.props=h(r),Object.keys(t).forEach(n=>{e.props[n]=a(t[n],r)})),e}if((t instanceof r.P.Uint8Array||t instanceof r.ot.Uint8Array)&&4===w(t)){const n=Object.keys(t);n.length!==t.length&&g(t);const o=t=>Number.isInteger(t)&&t<=255&&t>=0;n.some(e=>!o(t[e]))&&g(t);const i=h(r);r.Ct.set(t,i);const s=e.from(new Uint8Array(t));return i.$ui8a=s.toString("base64"),i}if(r.K){const e=r.K(t,r);if(e)return e}g(t)}(t,r)}}g(t)}function u(t,e){if("object"!=typeof t&&"function"!=typeof t||!t)return t;const r=e.get(t);return r||(Object.keys(t).forEach(r=>{t[r]=u(t[r],e)}),t)}function f(t,r){switch(typeof t){case"string":case"boolean":return t;case"number":if(isNaN(t)||!isFinite(t)||Object.is(t,-0))break;return t;case"object":case"function":return t?function(t,r){if(b(t)){let n;if(Object.keys(t).forEach(e=>{e.startsWith("$")&&(n&&d(t),n=e)}),!n){const e=r.Lt||h(r);return delete r.Lt,r.Gt?e:(Object.keys(t).forEach(n=>{e[n]=f(t[n],r)}),e)}if("$undef"===n&&1===t.$undef)return;if("$n0"===n&&1===t.$n0)return-0;if("$nan"===n&&1===t.$nan)return NaN;if("$inf"===n&&1===t.$inf)return 1/0;if("$ninf"===n&&1===t.$ninf)return-1/0;if("$arr"===n){b(t.$arr)&&t.$arr||d(t);const e=r.Lt||l(r);if(delete r.Lt,r.Gt)return e;const n=t.$arr;return Object.keys(n).forEach(t=>{e[t]=f(n[t],r)}),e}if("$obj"===n){b(t.$obj)&&t.$obj||d(t);const e=r.Lt||h(r);if(delete r.Lt,r.Gt)return e;const n=t.$obj;return Object.keys(n).forEach(t=>{e[t]=f(n[t],r)}),e}if("$set"===n){_(t.$set)||d(t),m(t.props)||b(t.props)||d(t);const e=r.Lt||p(r);if(delete r.Lt,r.Gt)return e;for(const n of t.$set)e.add(f(n,r));const n=t.props;return n&&Object.keys(n).forEach(t=>{e[t]=f(n[t],r)}),e}if("$map"===n){_(t.$map)||d(t),m(t.props)||b(t.props)||d(t);const e=r.Lt||y(r);if(delete r.Lt,r.Gt)return e;for(const n of t.$map)_(n)&&2===n.length||d(t),e.set(f(n[0],r),f(n[1],r));const n=t.props;return n&&Object.keys(n).forEach(t=>{e[t]=f(n[t],r)}),e}if("$ui8a"===n){"string"!=typeof t.$ui8a&&d(t),t.$ui8a.split("").some(t=>!P.has(t))&&d(t);const n=e.from(t.$ui8a,"base64");return r.W.Uint8Array.from(n)}if("$dedup"===n){"object"==typeof t.$dedup&&t.$dedup||d(t),_(t.dups)||d(t),m(r.Bt)||d(t),r.Gt=!0,r.Bt=t.dups.map(t=>f(t,r)),delete r.Gt,t.dups.forEach((t,e)=>{r.Lt=r.Bt[e],f(t,r)});const e=f(t.$dedup,r);return delete r.Bt,e}if("$dup"===n)return _(r.Bt)||d(t),"number"==typeof t.$dup&&t.$dup>=0&&t.$dup<r.Bt.length||d(t),r.Bt[t.$dup]}if(_(t)){const e=r.Lt||l(r);if(delete r.Lt,r.Gt)return e;for(const n of t)e.push(f(n,r));return e}if(r.X){const e=r.X(t,r);if(delete r.Lt,e)return e}d(t)}(t,r):null}d(t)}const h=t=>new t.W.Object,l=t=>new t.W.Array,p=t=>new t.W.Set,y=t=>new t.W.Map,g=t=>{throw new Error("Cannot serialize "+o(t))},d=t=>{throw new Error("Cannot deserialize "+o(t))},w=t=>{if(!t)return 0;let e=0;do{e++,t=Object.getPrototypeOf(t)}while(t);return e},b=t=>t&&2===w(t),_=t=>Array.isArray(t)&&3===w(t),m=t=>void 0===t,P=new Set;"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(t=>P.add(t));const v=(...t)=>(...e)=>{for(const r of t){const t=r(...e);if(t)return t}};c.q={Y:function(t){return(e,r)=>{if(n(e)){const n=h(r);return n.$ref=t(e),n}}},Z:()=>(t,e)=>{if("object"==typeof t){const r={};return e.Ct.set(t,r),r.$arb=c.et(Object.assign({},t),e),r.T=c.et(t.constructor,e),r}},V:v,Ct:t=>(e,r)=>{const n=r.Ct.get(e);if(n)return n;const o=t(e,r);return o?(r.Ct.set(e,o),o):void 0}},c.tt={Y:function(t){return e=>{if(b(e)&&!m(e.$ref))return t(e.$ref)}},Z:()=>(t,e)=>{if(b(t)&&!m(t.$arb)&&!m(t.T)){const r=e.Lt||h(e);if(delete e.Lt,e.Gt)return r;Object.assign(r,c.rt(t.$arb,e));const n=c.rt(t.T,e);return Object.setPrototypeOf(r,n.prototype),r}},V:v},c.Jt=function(t){const e=[];return function t(e,r){"object"!=typeof e&&"function"!=typeof e||!e||(r(e),Object.keys(e).forEach(n=>t(e[n],r)))}(t,t=>{t.$ref&&e.push(t.$ref)}),e},t.exports=c}).call(this,r(9).Buffer)},function(t,e){class r{static parse(t){if("_"===t)return{};const e=e=>{throw new Error(`${e}: ${t}`)};if("string"!=typeof t&&e("Location must be a string"),t.length||e("Location must not be empty"),"!"===t[0])return{error:t.slice(1),location:t};const n=t.split("://");if(n.length>2&&e("Location must only have one protocol"),2===n.length)return Object.assign({},r.parse(n[0]),{innerLocation:n[1]});const o=t.split("_");o.length>2&&e("Location has an unexpected _ separator"),o.length<2&&e("Location requires a _ separator");const i={location:t};0!==o[0].length&&64!==o[0].length&&e("Location has an invalid txid length"),"?"===o[0][0]?i.tempTxid=o[0]:o[0].length&&(/^[a-fA-F0-9]*$/.test(o[0])||e("Location has invalid hex in its txid"),i.txid=o[0]);const s=o[1].slice(1),c=parseInt(s,10);switch(!isNaN(c)&&/^[0-9]*$/.test(s)||e("Location has an invalid index number"),o[1][0]){case"o":i.vout=c;break;case"i":i.vin=c;break;case"r":i.vref=c;break;default:e("Location has an invalid index category")}return i}static build(t){const e=e=>{throw new Error(`${e}: ${JSON.stringify(t)}`)};if("object"==typeof t&&t||e("Location object is invalid"),void 0!==t.innerLocation&&"string"!=typeof t.innerLocation&&e("Inner location must be a string"),void 0!==t.error&&"string"!=typeof t.error&&e("Error must be a string"),void 0!==t.error)return"!"+t.error;let r=t.location;if(!r){const n=""+(t.txid||t.tempTxid||"");let o=null,i=null;"number"==typeof t.vout?(o="o",i=t.vout):"number"==typeof t.vin?(o="i",i=t.vin):"number"==typeof t.vref?(o="r",i=t.vref):e("Location index unspecified"),(isNaN(i)||!isFinite(i)||!Number.isInteger(i)||i<0)&&e("Location index must be a non-negative integer"),r=`${n}_${o}${i}`}return t.innerLocation?`${r}://${t.innerLocation}`:r}}t.exports=r},function(t,e,r){const n=r(6),{JigControl}=r(3),{k:o}=r(0);class ResourceMap{constructor(t){const e=internal(this);if(e.qt=new Map,e.Yt=new Map,e.Qt=new Set,t)for(const[e,r]of t)this.set(e,r)}clear(){const t=internal(this);t.qt.clear(),t.Yt.clear(),t.Qt.clear()}delete(t){const e=internal(this),r=uniqueKey(e,t);return e.Qt.delete(r),e.Yt.delete(r),e.qt.delete(r)}get(t){return internal(this).qt.get(uniqueKey(internal(this),t))}set(t,e){return internal(this).qt.set(uniqueKey(internal(this),t),e),this}has(t){return internal(this).qt.has(uniqueKey(internal(this),t))}get size(){return internal(this).qt.size}get[Symbol.species](){return ResourceMap}entries(){return internal(this).qt.entries()}keys(){return internal(this).qt.keys()}forEach(t,e){return internal(this).qt.forEach(t,e)}values(){return internal(this).qt.values()}[Symbol.iterator](){return internal(this).qt[Symbol.iterator]()}}ResourceMap.deps={internal,uniqueKey};class i{constructor(t){if(internal(this).map=new ResourceMap,t)for(const e of t)this.add(e)}get size(){return internal(this).map.size}get[Symbol.species](){return i}add(t){return internal(this).map.set(t,t),this}clear(){internal(this).map.clear()}delete(t){return internal(this).map.delete(t)}entries(){return internal(this).map.entries()}forEach(t,e){return internal(this).map.forEach(r=>t.call(e,r))}has(t){return internal(this).map.has(t)}values(){return internal(this).map.values()}[Symbol.iterator](){return internal(this).map.keys()}}i.deps={internal,ResourceMap};const s=t=>JigControl.g(()=>t.origin||t.location),c=t=>JigControl.g(()=>t.location);let a=!1;function uniqueKey(t,e){if(!e||!o(e))return e;const r=()=>{if(a)return;throw new Error("Inconsistent worldview\n\nFound two resources with the same origin at different locations.\n\nHint: Try syncing the relevant resources before use.")};if(!(t=>{try{return!!n.parse(s(t)).txid}catch(t){return!1}})(e))return t.Qt.add(e),e;const i=s(e),u=c(e);for(const e of t.Qt)if(i===s(e)){return u!==c(e)&&r(),t.Qt.delete(e),t.Yt.set(i,e),e}const f=t.Yt.get(i);if(f){return u!==c(f)&&r(),f}return t.Yt.set(i,e),e}const u=new WeakMap;function internal(t){const e=JigControl.N(()=>t.$target||t);return u.has(e)||u.set(e,{}),u.get(e)}t.exports={ResourceMap,ResourceSet:i,Zt:function(t){const e=a;a=!0;try{t()}finally{a=e}}}},function(t,e){function r(t){if(!(t.outputs.length&&t.outputs[0].script.isSafeDataOut()&&7===t.outputs[0].script.chunks.length&&"run"===t.outputs[0].script.chunks[2].buf.toString("utf8")))throw new Error("not a run tx: "+t.hash);const e=t.outputs[0].script.chunks[3].buf;if(!(1===e.length&&2===e[0])){const r="Hint: Are you trying to load jigs created by a different version of run? This is not possible in the private alpha, sorry.",n=`Txid: ${t.hash}\nProtocol: ${e.toString("hex")}`;throw new Error(`Unsupported run protocol\n\n${n}\n\n${r}`)}}const n=" abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`1234567890-=~!@#$%^&*()_+,./;'[]\\<>?:\"{}|".split(""),o="t08sY]m'#$Dy1`}pCKrHG)f9[uq%3\\ha=!ZVMkJ-*L\"xz67R? W~@wdO:Ecg|ITe52.+{ovBj>(&,/Q4lA;^<NPnXSFi_Ub".split("");function i(t){const e=t.split("").map(t=>-1!==o.indexOf(t)?n[o.indexOf(t)]:t).join("");try{return JSON.parse(e)}catch(t){throw new Error(`unable to parse decrypted run data\n\n${t.toString()}\n\n${e}`)}}t.exports={PROTOCOL_VERSION:2,Ht:r,Wt:function(t){return r(t),i(t.outputs[0].script.chunks[5].buf.toString("utf8"))},Kt:function(t,e){try{r(t)}catch(t){return"other"}if(0===e)return"rundata";const n=t.outputs[0].script.chunks[5].buf.toString("utf8");try{const t=i(n);if(e>=1&&e<1+t.code.length)return"code";if(e>=1+t.code.length&&e<1+t.code.length+t.jigs)return"jig"}catch(t){}return"other"},Vt:function(t){return JSON.stringify(t).split("").map(t=>-1!==n.indexOf(t)?o[n.indexOf(t)]:t).join("")},zt:i}},function(t,e,r){"use strict";(function(t){var n=r(27),o=r(28),i=r(29);function s(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=a.prototype:(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,r){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,r)}function u(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);a.TYPED_ARRAY_SUPPORT?(t=e).__proto__=a.prototype:t=l(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!a.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|y(e,r),o=(t=c(t,n)).write(e,r);o!==n&&(t=t.slice(0,o));return t}(t,e,r):function(t,e){if(a.isBuffer(e)){var r=0|p(e.length);return 0===(t=c(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?c(t,0):l(t,e);if("Buffer"===e.type&&i(e.data))return l(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(f(e),t=c(t,e<0?0:0|p(e)),!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function l(t,e){var r=e.length<0?0:0|p(e.length);t=c(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function y(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return L(t).length;default:if(n)return D(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,r);case"utf8":case"utf-8":return A(this,e,r);case"ascii":return x(this,e,r);case"latin1":case"binary":return T(this,e,r);case"base64":return S(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:b(t,e,r,n,o);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):b(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,o){var i,s=1,c=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,c/=2,a/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var f=-1;for(i=r;i<c;i++)if(u(t,i)===u(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===a)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(r+a>c&&(r=c-a),i=r;i>=0;i--){for(var h=!0,l=0;l<a;l++)if(u(t,i+l)!==u(e,l)){h=!1;break}if(h)return i}return-1}function _(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var c=parseInt(e.substr(2*s,2),16);if(isNaN(c))return s;t[r+s]=c}return s}function m(t,e,r,n){return G(D(e,t.length-r),t,r,n)}function P(t,e,r,n){return G(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function v(t,e,r,n){return P(t,e,r,n)}function E(t,e,r,n){return G(L(e),t,r,n)}function O(t,e,r,n){return G(function(t,e){for(var r,n,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function S(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function A(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,c,a,u=t[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=r)switch(h){case 1:u<128&&(f=u);break;case 2:128==(192&(i=t[o+1]))&&(a=(31&u)<<6|63&i)>127&&(f=a);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(a=(15&u)<<12|(63&i)<<6|63&s)>2047&&(a<55296||a>57343)&&(f=a);break;case 4:i=t[o+1],s=t[o+2],c=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&c)&&(a=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&c)>65535&&a<1114112&&(f=a)}null===f?(f=65533,h=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}e.Buffer=a,e.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),a.poolSize=8192,a.Xt=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,r){return u(null,t,e,r)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,r){return function(t,e,r,n){return f(e),e<=0?c(t,e):void 0!==r?"string"==typeof n?c(t,e).fill(r,n):c(t,e).fill(r):c(t,e)}(null,t,e,r)},a.allocUnsafe=function(t){return h(null,t)},a.allocUnsafeSlow=function(t){return h(null,t)},a.isBuffer=function(t){return!(null==t||!t.te)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=a.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var s=t[r];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},a.byteLength=y,a.prototype.te=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):g.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,r,n,o){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),c=Math.min(i,s),u=this.slice(n,o),f=t.slice(e,r),h=0;h<c;++h)if(u[h]!==f[h]){i=u[h],s=f[h];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},a.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return _(this,t,e,r);case"utf8":case"utf-8":return m(this,t,e,r);case"ascii":return P(this,t,e,r);case"latin1":case"binary":return v(this,t,e,r);case"base64":return E(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.ee||this,0)}};function x(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function T(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function I(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=e;i<r;++i)o+=B(t[i]);return o}function j(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function $(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,r,n,o,i){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function k(t,e,r,n){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-r,2);o<i;++o)t[r+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function M(t,e,r,n){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-r,4);o<i;++o)t[r+o]=e>>>8*(n?o:3-o)&255}function F(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,n,i){return i||F(t,0,r,4),o.write(t,e,r,n,23,4),r+4}function N(t,e,r,n,i){return i||F(t,0,r,8),o.write(t,e,r,n,52,8),r+8}a.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),a.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=a.prototype;else{var o=e-t;r=new a(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+t]}return r},a.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||$(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},a.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||$(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},a.prototype.readUInt8=function(t,e){return e||$(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||$(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||$(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||$(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||$(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||$(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||$(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},a.prototype.readInt8=function(t,e){return e||$(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||$(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){e||$(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return e||$(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||$(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||$(t,4,this.length),o.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||$(t,4,this.length),o.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||$(t,8,this.length),o.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||$(t,8,this.length),o.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},a.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},a.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);R(this,t,e,r,o-1,-o)}var i=0,s=1,c=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===c&&0!==this[e+i-1]&&(c=1),this[e+i]=(t/s>>0)-c&255;return e+r},a.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);R(this,t,e,r,o-1,-o)}var i=r-1,s=1,c=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===c&&0!==this[e+i+1]&&(c=1),this[e+i]=(t/s>>0)-c&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return N(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return N(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o,i=n-r;if(this===t&&r<e&&e<n)for(o=i-1;o>=0;--o)t[o+e]=this[o+r];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},a.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var s=a.isBuffer(t)?t:D(new a(t,n).toString()),c=s.length;for(i=0;i<r-e;++i)this[i+e]=s[i%c]}return this};var C=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function L(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}}).call(this,r(13))},function(t,e,r){const Context=r(17);class Berry{constructor(...t){const e=Context.A();if(!e.code.isSandboxed(this.constructor)){e.transaction.begin();try{return new(e.code.deploy(this.constructor))(...t)}finally{e.transaction.end()}}const r=[];let n=this.constructor;for(;n!==Berry;)r.push(n),n=Object.getPrototypeOf(n);if(0===r.length)throw new Error("Berry must be extended");const o=/\s+constructor\s*\(/;if(r.some(t=>o.test(t.toString())))throw new Error("Berry must use init() instead of constructor()");if(!BerryControl.re||BerryControl.re!==this.constructor)throw new Error("Must only create Berry from its own plucker");if(this.init(...t),void 0!==this.location)throw new Error("Berry init() must not set a location");if(!BerryControl.location)throw new Error("Must only pluck one berry at a time");this.location=BerryControl.location,BerryControl.location=void 0,Context.deepFreeze(this)}init(){}static[Symbol.hasInstance](t){const e=Context.A();if("object"!=typeof t)return!1;if(t===t.constructor.prototype)return!1;let r=e.code.jt(this);if(!r){const t=Context.j(e.blockchain.network);if(r=e.code.jt(this["origin"+t]),!r)return!1}let n=Object.getPrototypeOf(t);for(;n;){if(n===r.prototype)return!0;n=Object.getPrototypeOf(n)}return!1}}const BerryControl={re:void 0,location:void 0};const n={BerryControl,Context};t.exports={Berry,BerryControl,ne:n,oe:async function t(e,n,o,i){const{J:s}=r(0),c=r(6),a=async t=>s(await n.fetch(t)),u=e=>t(e,n,o,i),f=BerryControl.re,h=BerryControl.location;try{const t=o.ie(i);BerryControl.re=t,c.parse(t.location).error?BerryControl.location=c.build({error:i.name+" not deployed"}):BerryControl.location=c.build({location:t.location,innerLocation:e});const r=await t.pluck(e,a,u,t);if(!r)throw new Error(`Failed to load berry using ${i.name}: ${e}`);if(!(r instanceof Berry))throw new Error("Plucker must return an instance of Berry");return r}finally{BerryControl.re=f,BerryControl.location=h}}}},function(t,e,r){(function(e){const n=r(2),{F:o}=r(0);function i(t){const{Hash:e}=n.crypto;return t._hash=t._hash||e.sha256(t.toBuffer()).reverse().toString("hex"),t._hash}t.exports={ae:async function(t,e){for(let r=0;r<t.inputs.length;r++){const o=t.inputs[r];if(!o.output){const t=o.prevTxId.toString("hex"),r=await e.fetch(t);o.output=r.outputs[o.outputIndex],o.output.script.isPublicKeyHashOut()&&Reflect.setPrototypeOf(o,n.Transaction.Input.PublicKeyHash.prototype)}}},Co:i,se:function(t){const{Script:r,Transaction:n}=t,{Interpreter:o}=r,{Input:s}=n,{ECDSA:c,Hash:a,Signature:u}=t.crypto,{BufferReader:f,BufferWriter:h}=t.encoding,{_:l}=t.deps;n.FEE_PER_KB=500;const p=n.prototype.sign;function y(...t){Object.assign(this,new n(t[0]))}n.prototype.sign=function(...t){const e=s.prototype.isValidSignature;s.prototype.isValidSignature=()=>!0;const r=p.call(this,...t);return s.prototype.isValidSignature=e,r},y.prototype=Object.create(n.prototype),Object.defineProperty(y.prototype,"hash",{configurable:!1,enumerable:!0,get:function(){return this._hash=this._hash||new f(this._getHash()).readReverse().toString("hex"),this._hash}}),n.prototype.lock=function(){return delete this._hash,Object.setPrototypeOf(this,y.prototype)},Object.defineProperty(r.prototype,"hash",{configurable:!1,enumerable:!0,get:()=>i(this)}),s.prototype.clearSignatures=()=>{},s.prototype.getSignatures=()=>[],s.prototype.isFullySigned=()=>!0,n.prototype.isFullySigned=function(){return l.every(l.map(this.inputs,t=>t.isFullySigned()))},n.prototype.isValidSignature=function(t){const e=new o,r=t.inputIndex,n=this.inputs[r],i=o.SCRIPT_VERIFY_STRICTENC|o.SCRIPT_VERIFY_DERSIG|o.SCRIPT_VERIFY_LOW_S|o.SCRIPT_VERIFY_NULLDUMMY|o.SCRIPT_VERIFY_SIGPUSHONLY|o.SCRIPT_ENABLE_MONOLITH_OPCODES|o.SCRIPT_ENABLE_MAGNETIC_OPCODES|o.SCRIPT_ENABLE_SIGHASH_FORKID;return e.verify(n.script,n.output.script,this,r,i,n.output.satoshisBN)},n.prototype.signature=function(t,r,n=u.SIGHASH_ALL){n|=u.SIGHASH_FORKID;const i=this.inputs[t].output.script,s=this.inputs[t].output.satoshisBN,p=(o.SCRIPT_ENABLE_SIGHASH_FORKID,function(t,r,n,o,i){const s=t.inputs[n];function c(e){const r=new h;if(l.isUndefined(e)){if(t._hashOutputsAll)return t._hashOutputsAll;l.each(t.outputs,(function(t){t.toBufferWriter(r)}))}else t.outputs[e].toBufferWriter(r);const n=r.toBuffer(),o=a.sha256sha256(n);return l.isUndefined(e)&&(t._hashOutputsAll=o),o}let p=e.alloc(32),y=e.alloc(32),g=e.alloc(32);r&u.SIGHASH_ANYONECANPAY||(p=function(){if(t._hashPrevouts)return t._hashPrevouts;const e=new h;l.each(t.inputs,(function(t){e.writeReverse(t.prevTxId),e.writeUInt32LE(t.outputIndex)}));const r=e.toBuffer();return t._hashPrevouts=a.sha256sha256(r),t._hashPrevouts}()),r&u.SIGHASH_ANYONECANPAY||(31&r)===u.SIGHASH_SINGLE||(31&r)===u.SIGHASH_NONE||(y=function(){if(t._hashSequence)return t._hashSequence;const e=new h;l.each(t.inputs,(function(t){e.writeUInt32LE(t.sequenceNumber)}));const r=e.toBuffer();return t._hashSequence=a.sha256sha256(r),t._hashSequence}()),(31&r)!==u.SIGHASH_SINGLE&&(31&r)!==u.SIGHASH_NONE?g=c():(31&r)===u.SIGHASH_SINGLE&&n<t.outputs.length&&(g=c(n));const d=new h;d.writeInt32LE(t.version),d.write(p),d.write(y),d.writeReverse(s.prevTxId),d.writeUInt32LE(s.outputIndex),d.writeVarintNum(o.toBuffer().length),d.write(o.toBuffer()),d.writeUInt64LEBN(i),d.writeUInt32LE(s.sequenceNumber),d.write(g),d.writeUInt32LE(t.nLockTime),d.writeUInt32LE(r>>>0);const w=d.toBuffer(),b=a.sha256sha256(w);return new f(b).readReverse()}(this,n,t,i,s)),y=c.sign(p,r,"little"),g=e.from(y.toDER());return e.concat([g,e.from([255&n])])}},Do:function(t){if("string"==typeof t)return new n.Transaction(t);if(t instanceof Uint8Array){const e=n.deps.Buffer.from(t);return new n.Transaction(e)}if(t instanceof n.Transaction)return t;throw new Error(o(t)+" is not a transaction")}}}).call(this,r(9).Buffer)},function(t,e){class NotImplementedError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class TimeoutError extends Error{constructor(t){super(t),this.name=this.constructor.name}}t.exports={NotImplementedError,TimeoutError}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){const n=r(1),{TimeoutError}=r(12);class o{static async Nr(t,e=2e3){return o.xo(t,"GET",void 0,e)}static async Hr(t,e,r=2e3){return o.xo(t,"POST",e,r)}static async xo(t,e,r,o){n.ct("REST",e,t);let s=null;try{s=await i(t,e,r,o)}catch(r){throw r.message+=`\n\n${e} ${t}`,r}const{data:c,status:a,statusText:u}=s;if(a>=200&&a<300)return c;const f=c.message?c.message.message||c.message:c,h=c.name&&f?`${c.name}: ${f}`:c.name||f;throw new Error(`${a} ${u}\n\n${e} ${t}\n\n${h}`)}}let i=null;i=async function(t,e,r,n){const{AbortController:o,fetch:i}=window,s=new o,c={accept:"application/json"};r&&(c["content-type"]="application/json");const a={method:e,body:JSON.stringify(r),headers:c,signal:s.signal};let u=!1;const f=setTimeout(()=>{u=!0,s.abort()},n);try{const e=await i(t,a);let r=null;return r=e.headers.get("content-type").includes("application/json")?await e.json():await e.text(),{data:r,status:e.status,statusText:e.statusText}}catch(t){if(u)throw new TimeoutError(`Request timed out after ${n}ms`);throw t}finally{clearTimeout(f)}},t.exports=o},function(t,e){function hex(t){if("string"!=typeof t||t.length%2!=0)throw new Error("Bad hex: "+t);t=t.toLowerCase();const e="0123456789abcdef".split(""),r=[];for(let n=0;n<t.length;n+=2){const o=e.indexOf(t[n]),i=e.indexOf(t[n+1]);if(-1===o||-1===i)throw new Error("Bad hex: "+t);r.push(16*o+i)}return r}hex.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o2",hex.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o2",hex.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",hex.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o2",hex.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o2",hex.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",t.exports=hex},function(t,e,r){(function(e,n){const o=r(2),i=r(24),{se:s}=r(11);!function(){if(e&&e.version){if(Number(e.version.match(/^v(\d+\.\d+)/)[1])<10)throw new Error("Run is supported only on Node v10 and above")}if("undefined"!=typeof window){const t=window.navigator.userAgent;if(-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident"))throw new Error("Run is not supported on Internet Explorer. Please upgrade to Edge.")}}(),n.Jig=i.Jig,n.Berry=i.Berry,n.Token=i.Token,s(o),t.exports=i}).call(this,r(23),r(13))},function(t,e,r){t.exports=class{static A(){return r(0).A()}static j(t){return r(0).j(t)}static D(t){return r(0).D(t)}static k(t){return r(0).k(t)}static H(t){return r(0).H(t)}static nt(t){return r(0).nt(t)}static At(){return this.A().transaction.ce()}static L(t){const{A:e,I:n,L:o}=r(0);return o(t,n(e().blockchain.network))}static U(...t){return r(0).U(...t)}static get Checkpoint(){return r(19)}static get O(){return r(4)._.O}static deepFreeze(t){Object.freeze(t)}}},function(t,e){class StandardLock{constructor(t){this.address=t}get script(){if("string"!=typeof this.address)throw new Error("Address is not a string: "+this.address);const t=[],e=[];let r,n,o;const i=this.address;for(let s=0;s<i.length;s++){if(r=0,n="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(i[s]),n<0)throw new Error(`Invalid character in address: ${i}\n\nDetails: i=${s}, c=${i[s]}`);for(n||e.length^s||e.push(0);r in t||n;)o=t[r],o=o?58*o+n:n,n=o>>8,t[r]=o%256,r++}for(;r--;)e.push(t[r]);if(e.length<6)throw new Error("Address too short: "+i);if(0!==e[0]&&111!==e[0])throw new Error("Address may only be a P2PKH type: "+i);const s=[118,169,20,...e.slice(1,e.length-4),136,172];return new Uint8Array(s)}}StandardLock.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o5",StandardLock.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o5",StandardLock.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",StandardLock.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o5",StandardLock.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o5",StandardLock.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",StandardLock.toString(),t.exports=StandardLock},function(t,e,r){const n=r(5),{JigControl}=r(3),{k:o}=r(0);t.exports=class{constructor(t,e,r){this.Ro=[],this.qn={K:n.q.V(n.q.Y(t=>(this.Ro.push(t),this.Ro.length-1)),n.q.Z()),X:n.tt.V(n.tt.Y(t=>this.Ro[t]),n.tt.Z())},JigControl.g(()=>{JigControl.$t(()=>{this.Fo=n.et(t,this.qn)})}),this.Ro.forEach(t=>{"code"===o(t)&&e.deploy(t)})}restore(){return this.Uo=this.Uo||n.rt(this.Fo,this.qn),this.Uo}equals(t){const e=(t,r)=>typeof t==typeof r&&("object"==typeof t&&"object"==typeof r?null===t&&null===r||null!==t&&null!==r&&(Object.keys(t).length===Object.keys(r).length&&Object.keys(t).every(n=>e(t[n],r[n]))):t===r);return!!e(this.Fo,t.Fo)&&(this.Ro.length===t.Ro.length&&this.Ro.every((e,r)=>this.Ro[r]===t.Ro[r]))}}},function(t,e,r){(function(e){const n=r(2),{JigControl}=r(3),o=r(5),{ae:i,Do:s}=r(11),{ResourceSet:c}=r(7),a=r(1),u=r(6),{I:f,j:h,k:l,R:p,F:y,M:g,B:d,L:w}=r(0),{PROTOCOL_VERSION:b,Wt:_,Vt:m}=r(8);t.exports=class{constructor(t){this.ue=t,this.fe()}fe(){this.he=[],this.le=[],this.yt=new Map,this.pe=new Map,this.ye=[],this.ge=[],this.pt=new Set,this.dt=new Map,this.de=new Map,this.we=0,this.be=!1,this._e=!1,this.me=null}Pe(){return!this.he.length&&(!this.le.length&&!this.we)}async ve(t,r,s,c,u,p){if(!this.Pe())throw new Error("Cannot import: Transaction already in progress");i(t,r.Ee),this.be=!0,this.we=1;const y=_(t),g=f(r.Ee.network);let b=1;const m=[];for(const e of y.code){const n=`${t.hash}_o${b++}`,o=await r.he.Oe(e,n,t,r,g,p);m.push(o)}if(u&&u>0&&u<1+y.code.length)return void(this.he=new Array(y.code.length));const P=new Map;y.refs&&y.refs.forEach(t=>P.set(t,t));for(const e of y.actions){const r=e=>{if("_"!==e[0]&&P.set(e,e),"i"===e[1]){const r=t.inputs[parseInt(e.slice(2))];P.set(e,`${r.prevTxId.toString("hex")}_o${r.outputIndex}`)}};e.target&&"init"!==e.method&&r(e.target),o.Jt(e.args).forEach(t=>r(t))}for(const[,e]of P){const n=await r.Ee.fetch(e.slice(0,64)),o=parseInt(e.slice(66));if(void 0===n.outputs[o].spentTxId)throw new Error("Cannot check if read is stale. Blockchain API does not support spentTxId.");if(null===n.outputs[o].spentTxId)continue;const i=await r.Ee.fetch(n.outputs[o].spentTxId);if(i.time<=t.time&&i.time>=n.time&&t.time-n.time>72e5&&t.hash!==i.hash)throw new Error(e+" is stale. Aborting.")}for(const[t,e]of P)if(s&&e===s.location)P.set(t,s);else try{P.set(t,await r.Se.load(e))}catch(r){throw a.ut("Record",r),new Error(`Error loading ref ${t} at ${e}\n\n${r}`)}s&&P.set(s.location,s);const v=t=>{const e=e=>{if("jig"===l(e)&&e!==t){return Array.from(P.values()).find(t=>t.origin===e.origin)||e}return e};JigControl.g(()=>d(t,e))};for(const t of P.values())v(t);for(const e of y.actions){const n=t=>JigControl.g(()=>{if("_"!==t[0]||"i"===t[1]){const e=P.get(t);if(!e)throw new Error("Unexpected ref "+t);return e}if("r"===t[1]){const e=P.get(y.refs[parseInt(t.slice(2))]);if(!e)throw new Error("Unexpected ref "+t);return e}if("o"!==t[1])throw new Error("Unexpected ref "+t);const e=parseInt(t.slice(2))-1;return e<y.code.length?m[e]:this.dt.get(this.ge[e-y.code.length])}),i={ot:r.he.ot,X:o.tt.V(o.tt.Y(n),o.tt.Z())},s=o.rt(e.args,i);if("init"===e.method){if("_"===e.target[0]){const t=parseInt(e.target.slice(2));if(t<=0||t>=y.code.length+1)throw new Error("missing target "+e.target)}const n="_"===e.target[0]?t.hash+e.target:e.target,c=await r.Se.load(n),a=o.rt(e.creator,i);r.Se.Ae(this,a);try{new c(...s)}finally{r.Se.xe()}}else{const t=P.get(e.target)||this.dt.get(this.ge[parseInt(e.target.slice(2))-1-y.code.length]);if(v(t),void 0===t)throw new Error(`target ${e.target} missing`);r.Se.Ae(this,null);try{t[e.method](...s)}catch(t){throw new Error(`unexpected exception in ${e.method}\n\n${t}`)}finally{r.Se.xe()}}}const E=this.ye.filter(t=>"_"!==t.origin[0]);if(y.jigs!==this.ge.length)throw new Error(`bad number of jigs: ${y.jigs} != ${this.ge.length}`);if(t.inputs.length<E.length)throw new Error("not enough inputs");if(t.outputs.length<y.code.length+y.jigs+1)throw new Error("not enough outputs");E.forEach((e,r)=>{if(`${t.inputs[r].prevTxId.toString("hex")}_o${t.inputs[r].outputIndex}`!==(this.de.get(e.origin)||e.location))throw new Error("bad input "+r)}),this.ge.forEach((r,o)=>{const i=1+y.code.length+o;if(e.from(w(r.owner,g).script).toString("hex")!==t.outputs[i].script.toHex())throw new Error("Owner mismatch on output "+i);if(t.outputs[i].satoshis<Math.max(r.satoshis,n.Transaction.DUST_AMOUNT))throw new Error("bad satoshis on output "+i)}),c&&this.ge.forEach(e=>{const r=`${t.hash}_o${1+y.code.length+parseInt(e.location.slice(2))}`;"_"===e.origin[0]&&(e.origin=r),"_"===e.location[0]&&(e.location=r)});const O=this.ge.map(t=>this.dt.get(t)),S=new Array(1+y.code.length).concat(O),A=h(r.Ee.network);for(let e=0;e<S.length;e++){if(!S[e])continue;const n=`${t.hash.slice(0,64)}_o${e}`,i=JigControl.g(()=>{const n=Object.assign({},S[e]);(n.origin.startsWith(t.hash)||n.origin.startsWith("_"))&&delete n.origin,(n.location.startsWith(t.hash)||n.location.startsWith("_"))&&delete n.location;return o.et(n,{ot:r.he.ot,K:o.q.Ct(o.q.V(o.q.Y(e=>e.location.startsWith(t.hash)?e.location.slice(64):e.location),o.q.Z()))})});let s=S[e].constructor["origin"+A];s.startsWith(t.hash)&&(s=s.slice(64));const c={type:s,state:i};await r.Te.set(n,c)}this.he=[],y.code.forEach((e,n)=>{const o=`${t.hash}_o${n+1}`,i=r.he.jt(o),s=r.he.extractProps(i).props,c=i.owner;this.Ie(i,i,{},s,()=>{},()=>{},c,r.he,r)});const x=E.map(t=>this.de.get(t.origin)||t.location);this.me={tx:t,refs:y.refs||[],No:E,Mo:x};for(let e=0;e<this.he.length;e++)if(null===t.outputs[e+1].spentTxId){const t=this.he[e].S;r.$e.je(t)}for(let e=0;e<this.ge.length;e++)if(null===t.outputs[e+1+this.he.length].spentTxId){const t=this.ge[e],n=this.dt.get(t);r.$e.je(n)}this.be=!1,this._e=!0}ke(){this.we++}Re(){if(0===this.we)throw new Error("end transaction without begin");0==--this.we&&this.ue&&!this.Pe()&&this.ue()}Fe(t,e,r,n){delete this.me,this.he.forEach(t=>t.error()),this.he.forEach(t=>e.$e.je(t.S)),this.ge.forEach(e=>{if("_"===e.origin[0]||n){const t=`!${"_"===e.origin[0]?"Deploy failed":"A previous update failed"}\n\n${r}`;return Object.keys(e).forEach(t=>delete e[t]),void(e.origin=e.location=t)}if("_"!==e.location[0])return;const o=e.origin,i=this.yt.get(e).restore();JigControl.g(()=>{Object.keys(e).forEach(t=>delete e[t]),Object.assign(e,i),e.origin=o,e.location||(e.location=t.get(o))})}),this.ge.forEach(t=>e.$e.je(t)),this.fe()}Ie(t,e,r,n,o,i,s,c,a){delete this.me,this._e=!1,this.ke();try{"object"==typeof s&&a.Me(s.constructor),this.he.push({T:t,S:e,deps:r,props:n,success:o,error:i,owner:s});const c="_d"+(this.he.length-1);return t.owner=e.owner=s,this.be||a.$e.je(e),c}finally{this.Re()}}St(t,e,r,n,o,i,s,a,u,f){delete this.me,this._e=!1,this.ke();try{const f=new c([t]);n.forEach(t=>f.add(t)),o.forEach(t=>f.add(t)),i.forEach(t=>f.add(t)),s.forEach((t,e)=>{this.yt.set(e,this.yt.get(e)||t)}),a.forEach((t,e)=>{this.pe.set(e,t)}),n.forEach(t=>{const r=e=>p(t,e)&&e.location!==t.location;if(this.ye.some(r)){const n=this.ye.find(r),o=this.yt.get(n).Fo.location,i=`${"origin: "+t.origin}\n${"1st location (after update): "+n.location}\n${"1st location (before update): "+o}\n${"2nd location: "+t.location}`,s=o===t.location?"Hint: Multiple dfferent up-to-date instances of this jig were found. Try updating without the batch.":"Hint: Try syncing all instances of this jig before calling "+e;throw new Error(`${`Different location for ${n} found in ${e}()`}\n\n${i}\n\n${s}`)}this.ye.some(e=>p(t,e))||this.ye.push(t)}),o.forEach(t=>{const e=this.ge.findIndex(e=>p(t,e));if(-1!==e)return t.location="_o"+e,void(t.origin=t.origin||t.location);this.ge.push(t);(t=>t.origin&&"_"!==t.origin[0]&&t.location&&"_"!==t.location[0]&&!this.de.has(t.origin))(t)&&this.de.set(t.origin,t.location),t.location="_o"+(this.ge.length-1),t.origin=t.origin||t.location}),i.forEach(t=>this.pt.add(t)),u.forEach((t,e)=>this.dt.set(e,t));const h=s.get(t).restore().owner;this.le.push({target:t,method:e,creator:h,args:r,inputs:n,outputs:o,reads:i})}finally{this.Re()}this.be||o.forEach(t=>f.$e.je(u.get(t)))}async Ue(t){this.me||this.Ne(t),this.me.tx=s(await t.Ce.pay(this.me.tx)),this._e=!0}async Be(t){this.me||this.Ne(t);const e=this.ye.filter(t=>"_"!==t.origin[0]),r=this.me.tx.inputs.length-e.length,n=e.map(t=>this.yt.get(t)).map(t=>t.restore()).map(t=>w(t.owner)).concat(new Array(r));this.me.tx=s(await t.De.sign(this.me.tx,n))}Ne(t){if(this.me)return this.me;const e=t.Ee,r=t.Le,i=h(e.network),s=f(e.network),c=this.ye.filter(t=>"_"!==t.origin[0]),a=new Map;this.pt.forEach(t=>{if(c.includes(t)||this.ge.includes(t))return;const e=this.de.get(t.origin)||r.Ge.get(t.origin)||t.location,n=a.get(t.origin);if(n&&n!==e)throw new Error("read different locations of same jig "+t.origin);a.set(t.origin,e)});const d=Array.from(a.values()),_=t=>{let e=t;const n=Array.from(this.dt.entries()).filter(([t,r])=>r===e).map(([t,e])=>t);n.length&&(e=n[0]);const o=c.findIndex(t=>p(t,e));if(-1!==o)return"_i"+o;const i=this.ge.findIndex(t=>p(t,e));if(-1!==i)return"_o"+(1+this.he.length+i);const s=d.indexOf(a.get(e.origin));return-1!==s?"_r"+s:r.Ge.get(e.origin)||e.location},P={ot:t.he.ot,K:o.q.Ct(o.q.V(o.q.Y(t=>{switch(l(t)){case"jig":return _(t);case"berry":return(t=>{const e=u.parse(t.location).error;if(e)throw new Error("Cannot serialize berry: "+e);return t.location})(t);case"code":return"_"===(e=t)["location"+i][0]?"_o"+(parseInt(e["location"+i].slice(2))+1):e["location"+i];default:throw new Error("Unknown resource type: "+y(t))}var e}),o.q.Z()))},v=this.le.map(t=>{const{method:e}=t,n=o.et(t.args,P);if("init"===e){const r=t.target.constructor["origin"+i]||t.target.constructor["location"+i];return{target:"_"===r[0]?"_o"+(1+parseInt(r.slice(2))):r,method:e,args:n,creator:o.et(t.creator,P)}}const s=c.findIndex(e=>p(e,t.target));if(-1!==s)return{target:"_i"+s,method:e,args:n};const a=this.ge.findIndex(e=>p(e,t.target));return-1!==a?{target:"_o"+(1+this.he.length+a),method:e,args:n}:{target:"_"!==t.target.location[0]?t.target.location:r.Ge.get(t.target.origin),method:e,args:n}}),E={code:this.he.map(t=>{const e=Object.entries(t.deps).map(([t,e])=>{return{[t]:(r=e["location"+i],"_"===r[0]?"_o"+(1+parseInt(r.slice(2))):r)};var r}),r=e.length?Object.assign(...e):void 0,n=Object.keys(t.props).length?o.et(t.props,P):void 0,s=o.et(t.owner,P);return{text:g(t.T),deps:r,props:n,owner:s}}),actions:v,jigs:this.ge.length,refs:d.length?d:void 0},O=m(E),{Buffer:S}=n.deps,A=S.from("run","utf8"),x=S.from([b],"hex"),T=S.from(t.Je,"utf8"),I=S.from(O,"utf8"),j=S.from("r11r","utf8"),$=n.Script.buildSafeDataOut([A,x,T,I,j]),R=(new n.Transaction).addOutput(new n.Transaction.Output({script:$,satoshis:0})),k=c.map(t=>this.de.get(t.origin)||r.Ge.get(t.origin)||t.location);return c.forEach((t,e)=>{const r=k[e].slice(0,64),o=parseInt(k[e].slice(66)),i=this.yt.get(t),c=Math.max(n.Transaction.DUST_AMOUNT,i.restore().satoshis),a=w(i.restore().owner,s).script,u={txid:r,vout:o,script:n.Script.fromBuffer(S.from(a)),satoshis:c};R.from(u)}),this.he.forEach(t=>{const e=w(t.owner,s).script,r=n.Script.fromBuffer(S.from(e)),o=n.Transaction.DUST_AMOUNT;R.addOutput(new n.Transaction.Output({script:r,satoshis:o}))}),this.ge.forEach(t=>{const e=this.pe.get(t).restore(),r=w(e.owner,s).script,o=n.Script.fromBuffer(S.from(r)),i=Math.max(n.Transaction.DUST_AMOUNT,e.satoshis);R.addOutput(new n.Transaction.Output({script:o,satoshis:i}))}),R.outputs.forEach(t=>{t.spentTxId=null,t.spentIndex=null,t.spentHeight=null}),this.me={tx:R,refs:d,No:c,Mo:k},this.me}}}).call(this,r(9).Buffer)},function(t,e,r){const hex=r(15);function asm(t){const e=t.split(" ");let r=[];for(const t of e){if(void 0!==asm.OP_CODES[t]){r.push(asm.OP_CODES[t]);continue}const e=hex(t);if(0!==e[0])if(1===e.length&&e[0]>=1&&e[0]<=16)r.push(e[0]+80);else if(e.length<=75)r=r.concat(e.length).concat(e);else if(e.length<256)r=r.concat(asm.OP_CODES.OP_PUSHDATA1).concat([e.length]).concat(e);else if(e.length<65536){const t=[e.length/256,e.length%256];r=r.concat(asm.OP_CODES.OP_PUSHDATA2).concat(t).concat(e)}else{if(!(e.length<4294967296))throw new Error("Hex data too long");{const t=[e.length/256/256/256,e.length/256/256%256,e.length/256%256,e.length%256];r=r.concat(asm.OP_CODES.OP_PUSHDATA4).concat(t).concat(e)}}else r.push(e[0])}return new Uint8Array(r)}asm.OP_CODES={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_IF:99,OP_NOTIF:100,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SPLIT:127,OP_NUM2BIN:128,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_1ADD:139,OP_1SUB:140,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},asm.deps={hex},asm.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o1",asm.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o1",asm.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",asm.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o1",asm.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o1",asm.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",t.exports=asm},function(t,e){function expect(t){let e=!1;const r=t=>{if("object"!=typeof t||!t)return t;try{return JSON.stringify(t)}catch(e){return t.toString()}};function n(n,o,i){if(e?n:!n)throw new Error(i||`expected value${e?" not":""} to be ${o} but was ${r(t)}`)}return{get not(){return e=!e,this},toBe:(e,o)=>n(t===e,""+r(e),o),toEqual:(e,o)=>n(function t(e,r){return typeof e==typeof r&&("object"==typeof e&&"object"==typeof r?null===e&&null===r||null!==e&&null!==r&&(Object.keys(e).length===Object.keys(r).length&&Object.keys(e).every(n=>t(e[n],r[n]))):e===r)}(t,e),"equal to "+r(e),o),toBeInstanceOf:(e,r)=>n(t&&t instanceof e,"an instance of "+e.name,r),toBeDefined:e=>n(void 0!==t,"defined",e),toBeNull:e=>n(null===t,"null",e),toBeNumber:e=>n("number"==typeof t,"a number",e),toBeInteger:e=>n(Number.isInteger(t),"an integer",e),toBeLessThan:(e,r)=>n(t<e&&"number"==typeof t&&"number"==typeof e,"less than "+e,r),toBeLessThanOrEqualTo:(e,r)=>n(t<=e&&"number"==typeof t&&"number"==typeof e,"less than or equal to "+e,r),toBeGreaterThan:(e,r)=>n(t>e&&"number"==typeof t&&"number"==typeof e,"greater than "+e,r),toBeGreaterThanOrEqualTo:(e,r)=>n(t>=e&&"number"==typeof t&&"number"==typeof e,"greater than or equal to "+e,r),toBeBoolean:e=>n("boolean"==typeof t,"a boolean",e),toBeString:e=>n("string"==typeof t,"a string",e),toBeObject:e=>n(t&&"object"==typeof t,"an object",e),toBeArray:e=>n(Array.isArray(t),"an array",e),toBeClass:e=>n("function"==typeof t&&t.toString().startsWith("class"),"a class",e),toBeFunction:e=>n("function"==typeof t&&!t.toString().startsWith("class"),"a function",e)}}expect.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o3",expect.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o3",expect.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",expect.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o3",expect.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o3",expect.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",t.exports=expect},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var a,u=[],f=!1,h=-1;function l(){f&&a&&(f=!1,a.length?u=a.concat(u):h=-1,u.length&&p())}function p(){if(!f){var t=c(l);f=!0;for(var e=u.length;e;){for(a=u,u=[];++h<e;)a&&a[h].run();h=-1,e=u.length}a=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new y(t,e)),1!==u.length||f||c(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,r){const{PrivateKey:n,PublicKey:o,Address:i}=r(2),s=r(25),{Blockchain:c,Logger:a,Purse:u,State:f,Lock:h,Owner:l}=r(36),{Jig}=r(3),{Berry}=r(10),p=r(37),y=r(38),g=r(39),d=r(40),w=r(41),b=r(42),_=r(43),asm=r(21),expect=r(22),GroupLock=r(44),hex=r(15),Token=r(45),StandardLock=r(18),{PROTOCOL_VERSION:m}=r(8),{F:P}=r(0),v=r(4),E=r(1);class O{constructor(t={}){t=Object.assign({},O.defaults,t),this.logger=t.logger,this.It=new s,this.It.Ee=function(t){const{api:e,apiKey:r,blockchain:n,network:o,timeout:i}=t;if(n instanceof c)return n;const a=s._&&s._.Ee;if(void 0===n)switch(o){case"mock":return a instanceof w?a:new w;case"main":case"test":case"stn":return a instanceof p&&a.api===e&&a.apiKey===r&&a.timeout===i&&a.network===o?a:new p({api:e,apiKey:r,network:o,timeout:i,lastBlockchain:a});default:throw new Error("Unsupported network: "+o)}throw new Error("Invalid blockchain: "+P(n))}(t,this.logger),this.It.Ce=S(t.purse,this.blockchain,t.wallet),this.It.Je=A(t.app),this.It.Te=function(t){if(t instanceof f)return t;if(void 0===t)return O.instance&&O.instance.state?O.instance.state:new _;throw new Error("Invalid state: "+P(t))}(t.state),this.It.De=function(t,e,r){if(r){if(!(r instanceof l))throw new Error("wallet does not implement the Owner API");return r}if(t instanceof l)return t;if(void 0===t||"string"==typeof t||t instanceof n)try{return new y({privkey:t,blockchain:e})}catch(t){}if("string"==typeof t||t instanceof o||t instanceof i)try{return new d(t.toString())}catch(t){}if("object"==typeof t)try{return new d(t)}catch(t){}throw new Error("Invalid owner: "+P(t))}(t.owner,this.blockchain,t.wallet),this.It.he=t.code,this.It.Ve(),this.blockchain instanceof w&&this.purse instanceof g&&this.blockchain.fund(this.purse.bsvAddress,1e8),this.activate()}get app(){return this.It.Je}get blockchain(){return this.It.Ee}get code(){return this.It.he}get inventory(){return this.It.$e}get logger(){return E.it}get owner(){return function(t,e){const r=t=>{const e=`run.owner.${t} is now deprecated.`,r="Please switch to run.inventory."+t;E.at("Owner",`${e} ${r}`)};"jigs"in t||Object.defineProperty(t,"jigs",{configurable:!0,enumerable:!0,get:()=>{r("jigs");try{return e.jigs}catch(t){return[]}}});"code"in t||Object.defineProperty(t,"code",{configurable:!0,enumerable:!0,get:()=>{r("code");try{return e.code}catch(t){return[]}}});return t}(this.It.De,this.inventory)}get purse(){return this.It.Ce}get wallet(){return this.It.Ce===this.It.De?this.It.Ce:void 0}get sandbox(){return this.It.ze}get state(){return this.It.Te}get transaction(){return this.It.Se}set app(t){this.It.Je=A(t)}set logger(t){this.it=E.it=function(t){if(t instanceof a)return t;if(void 0===t)return E.st;if(null===t)return{};throw new Error("Invalid logger: "+P(t))}(t)}set purse(t){this.It.Ce=S(t,this.blockchain)}async load(t,e){return this.qe(),this.It.Ye(t,{re:e})}async deploy(t){return this.qe(),this.It.Me(t),await this.It.Le.Qe(),t.location}async sync(){await this.It.Le.Qe(),await this.It.$e.sync()}activate(){return this.It.Ze(),O.instance=this,E.it=this.it,this}deactivate(){return this.It.Xe(),E.it=E.st,O.instance=null,this}qe(){if(O.instance!==this){throw new Error("This Run instance is not active\n\n"+"Hint: Call run.activate() on this instance first")}}}function S(t,e,r){if(r){if(!(r instanceof u))throw new Error("wallet does not implement the Purse API");return r}if(t instanceof u)return t;switch(typeof t){case"string":return new g({privkey:t,blockchain:e});case"undefined":return new g({blockchain:e});case"object":if(t instanceof n)return new g({privkey:t,blockchain:e})}throw new Error("Invalid purse: "+P(t))}function A(t){switch(typeof t){case"string":return t;case"undefined":return"";default:throw new Error("Invalid app: "+P(t))}}O.defaults={},O.defaults.app="",O.defaults.network="main",O.defaults.logger=void 0,O.defaults.api=void 0,O.defaults.apiKey=void 0,O.defaults.purse=void 0,O.defaults.owner=void 0,O.configure=(t,e)=>{t.APP&&(O.defaults.app=t.APP),e=e||t.NETWORK||O.defaults.network,O.defaults.network=e,t.LOGGER&&(O.defaults.logger=JSON.parse(t.LOGGER)?console:{}),O.tr.dn.it=O.defaults.logger;const r=t.PURSE||t["PURSE_"+e.toUpperCase()];void 0!==r&&(O.defaults.purse=r);const n=t.OWNER||t["OWNER_"+e.toUpperCase()];void 0!==n&&(O.defaults.owner=n),void 0!==t.API&&(O.defaults.api=t.API);const o=t.APIKEY||t["APIKEY_"+(O.defaults.api||"").toUpperCase()];void 0!==o&&(O.defaults.apiKey=o)},O.Berry=Berry,O.Jig=Jig,O.StandardLock=StandardLock,O.BlockchainApi=p,O.LocalOwner=y,O.LocalPurse=g,O.Mockchain=w,O.PayServer=b,O.StateCache=_,O.Viewer=d,O.asm=asm,O.expect=expect,O.GroupLock=GroupLock,O.hex=hex,O.Token=Token,O.tr={},O.tr.wn=r(19),O.tr.bn=r(6),O.tr.dn=r(1),O.tr._n=r(14),O.tr.mn=r(5),O.tr.Pn=r(7).ResourceSet,O.tr.En=r(7).ResourceMap,Object.assign(O.tr,r(0)),Object.assign(O.tr,r(8)),O.api={},O.api.Blockchain=c,O.api.Logger=a,O.api.Purse=u,O.api.State=f,O.api.Lock=h,O.api.Owner=l,O.errors=r(12),O.sandbox=v,O.instance=null,O.version="0.5.25",O.protocol=m,t.exports=O},function(t,e,r){const n=r(2),o=r(26),i=r(31),s=r(33),c=r(34),a=r(35),{I:u,G:f}=r(0);class h{constructor(){this.Ee=null,this.Ce=null,this.Te=null,this.Je=null,this.De=null,this.ze=!0,this.he=null,this.Le=null,this.Tt=null,this.er=null,this.Se=null,this.$e=null,this.rr=new f}Ve(){if(!this.he)if(h._){h._.ze.toString()===this.ze.toString()?this.he=h._.he:(h._.he.deactivate(),this.he=new o(this))}else this.he=new o(this);this.Le=new i(this),this.Tt=new s(this),this.Se=new a(this),this.$e=new c(this)}Ye(t,e){return this.rr.enqueue(()=>this.Se.load(t,e))}Me(t){this.he.deploy(t)}Se(t){this.Se.Se(t)}Ze(){h._!==this&&(h._&&h._.Xe(),h._=this,n.Networks.defaultNetwork=n.Networks[u(this.Ee.network)],this.he.activate(this.Ee.network))}Xe(){h._&&(h._=null)}}h._=null,t.exports=h},function(t,e,r){(function(e){const{Jig,JigControl,Rt:n}=r(3),{Berry,ne:o}=r(10),i=r(4),{j:s,$:c,k:a,L:u,A:f,F:h}=r(0),l=r(1),p=r(5),y=["origin","location","owner","originMainnet","locationMainnet","ownerMainnet","originTestnet","locationTestnet","ownerTestnet","originStn","locationStn","ownerStn","originMocknet","locationMocknet","ownerMocknet"];t.exports=class{constructor(t){this.It=t,this.installs=new Map,this.pending=new Set,this.nr(),this.or()}isSandboxed(t){const e=this.installs.get(t);return e&&t===e}jt(t){return this.isSandboxed(t)?t:this.installs.get(t)}ie(t){return this.deploy(t,{jo:!0})}extractProps(t){const e=["deps",...y],r=Object.keys(t).filter(t=>!e.includes(t)),n={};r.forEach(e=>{n[e]=t[e]});const o=[];try{p.et(n,{K:p.q.Ct(p.q.V(p.q.Y(t=>(o.push(t),{})),p.q.Z()))})}catch(e){throw new Error(`A static property of ${t.name} is not supported\n\n${e}`)}return{props:n,refs:o}}deploy(t,e={}){if(this.pending.has(t))return;if(t===this.Jig||t===Jig)return this.Jig;if(t===this.Berry||t===Berry)return this.Berry;if(!c(t))throw new Error(t+" is not deployable");l.ct("Code","Deploying",t.name);const r=this.installs.get(t),n=f(),o=s(n.blockchain.network);if(r&&Object.keys(r).includes("origin"+o)&&Object.keys(r).includes("location"+o))return r;const u=Object.keys(t);if(u.includes("location"+o)){const e=this.installs.get(t["location"+o]);if(e)return e}if(u.includes("deps")&&(h=t.deps,null!==Object.getPrototypeOf(Object.getPrototypeOf(h))))throw new Error("deps must be an object");var h;y.forEach(e=>{if((e=>u.includes(e)&&"string"!=typeof t[e])(e))throw new Error(`${e} must be a string: ${t[e]}`)}),n.transaction.begin();try{const r={},s=Object.getPrototypeOf(t),c=u.includes("deps")?Object.assign({},t.deps):{},f=i._.O.Object;if(s!==Object.getPrototypeOf(Object)&&s!==f.getPrototypeOf(f)){if(r[s.name]=this.deploy(s,e),c[s.name]){if(this.jt(c[s.name])!==r[s.name])throw new Error("unexpected parent dependency "+s.name)}s.name in c||s===this.installs.get(Jig)||s===Jig||s===this.installs.get(Berry)||s===Berry||(c[s.name]=s)}const h=this.installs.get(t);if(h&&Object.keys(h).includes("origin"+o)&&Object.keys(h).includes("location"+o))return h;const[l,g]=this.Mt(t,r);this.installs.set(t,l),this.installs.set(l,l);const d=[],w=t=>(d.push(t),d.length-1),b=t=>this.jt(d[t])||d[t],_={K:p.q.Ct(p.q.V(p.q.Y(w),p.q.Z())),X:p.tt.V(p.tt.Y(b),p.tt.Z())},m=Object.assign({},t);let P=null;try{P=p.et(m,_)}catch(e){throw new Error(`A static property of ${t.name} is not supported\n\n${e}`)}if(u.includes("origin"+o)||u.includes("location"+o))u.includes("origin"+o)&&(l["origin"+o]=l.origin=t.origin=t["origin"+o]),l["location"+o]=l.location=t.location=t["location"+o]||t.origin,l["owner"+o]=l.owner=t.owner=t["owner"+o],this.installs.set(l["location"+o],l);else if(e.jo){const e="!Not deployed";l["origin"+o]=l.origin=t.origin=t["origin"+o]=e,l["location"+o]=l.location=t.location=t["location"+o]||t.origin,l["owner"+o]=l.owner=t.owner=t["owner"+o]=null}else{const e=n.blockchain.network,r=r=>{n.blockchain.network===e&&(t.origin=t.location=l.origin=l.location=r,t.owner=l.owner=t["owner"+o]),l["origin"+o]=l["location"+o]=r,t["origin"+o]=t["location"+o]=r,this.installs.set(r,l)},i=()=>{n.blockchain.network===e&&(delete t.origin,delete t.location,delete l.origin,delete l.location,delete t.owner,delete l.owner),delete t["origin"+o],delete t["location"+o],delete l["origin"+o],delete l["location"+o],delete t["owner"+o],delete l["owner"+o]},s=Object.assign({},m);y.forEach(t=>{delete s[t]}),delete s.deps;let a=null;try{this.pending.add(t),a=n.transaction.Ie(t,l,c,s,r,i)}finally{this.pending.delete(t)}t["origin"+o]=t["location"+o]=t.origin=t.location=a,l["origin"+o]=l["location"+o]=l.origin=l.location=a,t["owner"+o]=l["owner"+o]=l.owner=t.owner}d.filter(t=>"code"===a(t)).forEach(t=>this.deploy(t,e));try{const t=p.rt(P,_);Object.assign(l,t)}catch(e){throw new Error(`A static property of ${t.name} cannot be sandboxed\n\n${e}`)}return g&&Object.entries(c).forEach(([t,n])=>{n!==s&&n!==r[s.name]&&(g[t]=this.deploy(n,e))}),g&&this.ir(g),l}finally{n.transaction.end()}}async Oe(t,r,n,o,c,a=new Map){if(this.installs.has(r))return this.installs.get(r);if(a.has(r))return a.get(r);l.ct("Code","Installing",h(t.text),"from",r);const f=r.slice(0,64),y=parseInt(r.slice(66)),g={};let d=null,w=null;const b=new Promise((t,e)=>{d=t,w=e});a.set(r,b);try{const h=/^class \w* extends (\w*)[\s]*{/;let l=null;if(h.test(t.text)){l=t.text.match(h)[1];let e=(t.deps||{})[l];"Jig"===l&&void 0===e?g.Jig=this.Jig:"Berry"===l&&void 0===e?g.Berry=this.Berry:(e.startsWith("_")&&(e=n.hash+e),g[l]=await o.Se.load(e,{sr:a}))}const[w,b]=i._.Ut(t.text,g);w.origin=w.location=r;const _=s(o.Ee.network);if(w["origin"+_]=w["location"+_]=r,d(w),b){const e=Object.entries(t.deps||{}).map(([t,e])=>{if(t===l)return;const r=e.startsWith("_")?n.hash+e:e;return o.Se.load(r,{sr:a}).then(e=>{b[t]=e})});await Promise.all(e)}t.deps&&(w.deps={},Object.keys(t.deps).forEach(t=>{w.deps[t]=b&&b[t]||g[t]})),b&&this.ir(b);const m=new Map,P=p.Jt(t.owner),v=async t=>{const e="i"===t[1]||"o"===t[1]?f+t:t,r=await o.Se.load(e,{sr:a});m.set(t,r)},E=P.map(t=>v(t));await Promise.all(E);const O=p.rt(t.owner,{X:p.tt.V(p.tt.Y(t=>m.get(t)),p.tt.Z())});if(w.owner=O,w["owner"+_]=O,n.outputs[y].script.toHex()!==e.from(u(O,c).script).toString("hex"))throw new Error("bad def owner: "+r);if(t.props){const e=new Map,r=p.Jt(t.props),n=async t=>{const r="i"===t[1]||"o"===t[1]?f+t:t,n=await o.Se.load(r,{sr:a});e.set(t,n)},i=r.map(t=>n(t));await Promise.all(i);const s=p.rt(t.props,{X:p.tt.V(p.tt.Y(t=>e.get(t)),p.tt.Z())});Object.assign(w,s)}if(a.delete(r),this.installs.has(r)){throw new Error(`Code installed twice for ${r}\n\n${"This is an internal Run bug. Please report it to the library developers."}.`)}return this.installs.set(r,w),this.installs.set(w,w),w}catch(t){throw w(t),t}}nr(){this.Jig=this.Mt(Jig,n)[0],this.installs.set(Jig,this.Jig),this.installs.set(this.Jig,this.Jig)}or(){this.Berry=this.Mt(Berry,o)[0],this.installs.set(Berry,this.Berry),this.installs.set(this.Berry,this.Berry)}Mt(t,e){const r=this.installs.get(t);return r?[r,null]:i._.Mt(t,e)}ir(t){"caller"in t||Object.defineProperty(t,"caller",{get:()=>JigControl.kt(),set:()=>{throw new Error("Must not set caller")},configurable:!0,enumerable:!0})}activate(t){const e=s(t);this.installs.forEach((t,r)=>{"string"!=typeof r&&(void 0!==r["origin"+e]?(r.origin=r["origin"+e],t.origin=r["origin"+e]):(delete r.origin,delete t.origin),void 0!==r["location"+e]?(r.location=r["location"+e],t.location=r["location"+e]):(delete r.location,delete t.location),void 0!==r["owner"+e]?(r.owner=r["owner"+e],t.owner=r["owner"+e]):(delete r.owner,delete t.owner))})}}}).call(this,r(9).Buffer)},function(t,e,r){"use strict";e.byteLength=function(t){var e=u(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,n=u(t),s=n[0],c=n[1],a=new i(function(t,e,r){return 3*(e+r)/4-r}(0,s,c)),f=0,h=c>0?s-4:s;for(r=0;r<h;r+=4)e=o[t.charCodeAt(r)]<<18|o[t.charCodeAt(r+1)]<<12|o[t.charCodeAt(r+2)]<<6|o[t.charCodeAt(r+3)],a[f++]=e>>16&255,a[f++]=e>>8&255,a[f++]=255&e;2===c&&(e=o[t.charCodeAt(r)]<<2|o[t.charCodeAt(r+1)]>>4,a[f++]=255&e);1===c&&(e=o[t.charCodeAt(r)]<<10|o[t.charCodeAt(r+1)]<<4|o[t.charCodeAt(r+2)]>>2,a[f++]=e>>8&255,a[f++]=255&e);return a},e.fromByteArray=function(t){for(var e,r=t.length,o=r%3,i=[],s=0,c=r-o;s<c;s+=16383)i.push(f(t,s,s+16383>c?c:s+16383));1===o?(e=t[r-1],i.push(n[e>>2]+n[e<<4&63]+"==")):2===o&&(e=(t[r-2]<<8)+t[r-1],i.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,a=s.length;c<a;++c)n[c]=s[c],o[s.charCodeAt(c)]=c;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function f(t,e,r){for(var o,i,s=[],c=e;c<r;c+=3)o=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),s.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,o){var i,s,c=8*o-n-1,a=(1<<c)-1,u=a>>1,f=-7,h=r?o-1:0,l=r?-1:1,p=t[e+h];for(h+=l,i=p&(1<<-f)-1,p>>=-f,f+=c;f>0;i=256*i+t[e+h],h+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+t[e+h],h+=l,f-=8);if(0===i)i=1-u;else{if(i===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=u}return(p?-1:1)*s*Math.pow(2,i-n)},e.write=function(t,e,r,n,o,i){var s,c,a,u=8*i-o-1,f=(1<<u)-1,h=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,y=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),(e+=s+h>=1?l/a:l*Math.pow(2,1-h))*a>=2&&(s++,a/=2),s+h>=f?(c=0,s=f):s+h>=1?(c=(e*a-1)*Math.pow(2,o),s+=h):(c=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[r+p]=255&c,p+=y,c/=256,o-=8);for(s=s<<o|c,u+=o;u>0;t[r+p]=255&s,p+=y,s/=256,u-=8);t[r+p-y]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const n=r(1);n.version="0.1.10",n.variant="browser",t.exports=n},function(t,e,r){const n=r(2),{makeDeterministic:o,nonDeterministicIntrinsics:i}=r(3);t.exports=class{constructor(){const t=`var m=${o.toString()};m();`;{document.body||(document.body=document.createElement("body"));const e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e),this.iframeEval=e.contentWindow.eval,this.iframeEval(`${t};${n};SES.lockdown()`)}this.globalOverrides={},i.forEach(t=>{this.globalOverrides[t]=void 0});const e=this.makeNondeterministicCompartment();e.global.c=console,this.globalOverrides.console=e.evaluate("Object.assign(...Object.entries(c).map(([k, f])=>({[k]:(...a)=>f(...a)})))")}makeCompartment(){const t=this.makeNondeterministicCompartment();return Object.assign(t.global,this.globalOverrides),{evaluate:e=>t.evaluate(e),global:new Proxy({},{set:(e,r,n)=>(e[r]=t.global[r]=n,!0),deleteProperty:(e,r)=>(delete e[r],r in this.globalOverrides?t.global[r]=this.globalOverrides[r]:delete t.global[r],!0),defineProperty:(e,r,n)=>(Object.defineProperty(e,r,n),Object.defineProperty(t.global,r,n),!0)})}}makeNondeterministicCompartment(){return this.iframeEval("new Compartment()")}}},function(t){t.exports=JSON.parse('"!function(t,o){\\"object\\"==typeof exports&&\\"undefined\\"!=typeof module?o(exports):\\"function\\"==typeof define&&define.amd?define([\\"exports\\"],o):o((t=t||self).SES={})}(this,(function(t){\\"use strict\\";function o(t,o){if(!t)throw new TypeError(o)}const{getPrototypeOf:r}=Object;const{getOwnPropertyDescriptor:e,getPrototypeOf:n}=Object;function a(t){return n(t).constructor}const i=[\\"Array\\",\\"ArrayBuffer\\",\\"ArrayBufferPrototype\\",\\"ArrayIteratorPrototype\\",\\"ArrayPrototype\\",\\"AsyncFunction\\",\\"AsyncFunctionPrototype\\",\\"AsyncGenerator\\",\\"AsyncGeneratorFunction\\",\\"AsyncGeneratorPrototype\\",\\"AsyncIteratorPrototype\\",\\"Atomics\\",\\"BigInt\\",\\"BigIntPrototype\\",\\"BigInt64Array\\",\\"BigInt64ArrayPrototype\\",\\"BigUint64Array\\",\\"BigUint64ArrayPrototype\\",\\"Boolean\\",\\"BooleanPrototype\\",\\"DataView\\",\\"DataViewPrototype\\",\\"Date\\",\\"DatePrototype\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Error\\",\\"ErrorPrototype\\",\\"eval\\",\\"EvalError\\",\\"EvalErrorPrototype\\",\\"Float32Array\\",\\"Float32ArrayPrototype\\",\\"Float64Array\\",\\"Float64ArrayPrototype\\",\\"Function\\",\\"FunctionPrototype\\",\\"Generator\\",\\"GeneratorFunction\\",\\"GeneratorPrototype\\",\\"Int8Array\\",\\"Int8ArrayPrototype\\",\\"Int16Array\\",\\"Int16ArrayPrototype\\",\\"Int32Array\\",\\"Int32ArrayPrototype\\",\\"isFinite\\",\\"isNaN\\",\\"IteratorPrototype\\",\\"JSON\\",\\"Map\\",\\"MapIteratorPrototype\\",\\"MapPrototype\\",\\"Math\\",\\"Number\\",\\"NumberPrototype\\",\\"Object\\",\\"ObjectPrototype\\",\\"parseFloat\\",\\"parseInt\\",\\"Promise\\",\\"PromisePrototype\\",\\"Proxy\\",\\"RangeError\\",\\"RangeErrorPrototype\\",\\"ReferenceError\\",\\"ReferenceErrorPrototype\\",\\"Reflect\\",\\"RegExp\\",\\"RegExpPrototype\\",\\"RegExpStringIteratorPrototype\\",\\"Set\\",\\"SetIteratorPrototype\\",\\"SetPrototype\\",\\"SharedArrayBuffer\\",\\"SharedArrayBufferPrototype\\",\\"String\\",\\"StringIteratorPrototype\\",\\"StringPrototype\\",\\"Symbol\\",\\"SymbolPrototype\\",\\"SyntaxError\\",\\"SyntaxErrorPrototype\\",\\"ThrowTypeError\\",\\"TypedArray\\",\\"TypedArrayPrototype\\",\\"TypeError\\",\\"TypeErrorPrototype\\",\\"Uint8Array\\",\\"Uint8ArrayPrototype\\",\\"Uint8ClampedArray\\",\\"Uint8ClampedArrayPrototype\\",\\"Uint16Array\\",\\"Uint16ArrayPrototype\\",\\"Uint32Array\\",\\"Uint32ArrayPrototype\\",\\"URIError\\",\\"URIErrorPrototype\\",\\"WeakMap\\",\\"WeakMapPrototype\\",\\"WeakSet\\",\\"WeakSetPrototype\\",\\"escape\\",\\"unescape\\",\\"FunctionPrototypeConstructor\\",\\"Compartment\\",\\"CompartmentPrototype\\",\\"harden\\"],{getOwnPropertyDescriptor:c}=Object;function p(t,r){const e=c(t,r);return o(!(\\"get\\"in e||\\"set\\"in e),`unexpected accessor on global property: ${r}`),e.value}const{apply:s}=Reflect,y=(t=>(o,...r)=>s(t,o,r))(Object.prototype.hasOwnProperty);function l(){const t={__proto__:null},c=function(){const t=Function.prototype.constructor,o=typeof Symbol&&Symbol.iterator||\\"@@iterator\\",r=typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\",i=e(arguments,\\"callee\\").get,c=(new String)[o](),p=n(c);let s=null,y=null;r in new RegExp&&(s=(new RegExp)[r](),y=n(s));const l=(new Array)[o](),u=n(l),g=n(Float32Array),f=(new Map)[o](),P=n(f),b=(new Set)[o](),m=n(b),d=n(u);function*h(){}const A=a(h),E=A.prototype;async function*S(){}const _=a(S),w=_.prototype,I=w.prototype,F=n(I);async function T(){}const v=a(T),O={FunctionPrototypeConstructor:t,ArrayIteratorPrototype:u,AsyncFunction:v,AsyncGenerator:w,AsyncGeneratorFunction:_,AsyncGeneratorPrototype:I,AsyncIteratorPrototype:F,Generator:E,GeneratorFunction:A,IteratorPrototype:d,MapIteratorPrototype:P,RegExpStringIteratorPrototype:y,SetIteratorPrototype:m,StringIteratorPrototype:p,ThrowTypeError:i,TypedArray:g};return O}();!function(t){const{FunctionPrototypeConstructor:e,ArrayIteratorPrototype:n,AsyncFunction:a,AsyncGenerator:i,AsyncGeneratorFunction:c,AsyncGeneratorPrototype:p,AsyncIteratorPrototype:s,Generator:y,GeneratorFunction:l,IteratorPrototype:u,MapIteratorPrototype:g,RegExpStringIteratorPrototype:f,SetIteratorPrototype:P,StringIteratorPrototype:b,ThrowTypeError:m,TypedArray:d}=t;o(r(m)===Function.prototype,\\"ThrowTypeError.__proto__ should be Function.prototype\\"),o(r(b)===u,\\"StringIteratorPrototype.__proto__ should be IteratorPrototype\\"),f&&o(r(f)===u,\\"RegExpStringIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(d)===Function.prototype,\\"TypedArray.__proto__ should be Function.prototype\\"),o(r(g)===u,\\"MapIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(P)===u,\\"SetIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(u)===Object.prototype,\\"IteratorPrototype.__proto__ should be Object.prototype\\"),o(r(s)===Object.prototype,\\"AsyncIteratorPrototype.__proto__ should be Object.prototype\\"),o(r(n)===u,\\"AsyncIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(l)===e,\\"GeneratorFunction.__proto__ should be Function\\"),o(\\"GeneratorFunction\\"===l.name,\'GeneratorFunction.name should be \\"GeneratorFunction\\"\'),o(r(y)===Function.prototype,\\"Generator.__proto__ should be Function.prototype\\"),o(r(c)===e,\\"AsyncGeneratorFunction.__proto__ should be Function\\"),o(\\"AsyncGeneratorFunction\\"===c.name,\'AsyncGeneratorFunction.name should be \\"AsyncGeneratorFunction\\"\'),o(r(i)===Function.prototype,\\"AsyncGenerator.__proto__ should be Function.prototype\\"),o(r(p)===s,\\"AsyncGeneratorPrototype.__proto__ should be AsyncIteratorPrototype\\"),o(r(a)===e,\\"AsyncFunction.__proto__ should be Function\\"),o(\\"AsyncFunction\\"===a.name,\'AsyncFunction.name should be \\"AsyncFunction\\"\')}(c);for(const o of i){if(y(c,o)){t[o]=c[o];continue}if(y(globalThis,o)){t[o]=p(globalThis,o);continue}if(o.endsWith(\\"Prototype\\")){const r=o.slice(0,-\\"Prototype\\".length);if(y(c,r)){const e=c[r];t[o]=e.prototype;continue}if(y(globalThis,r)){const e=p(globalThis,r);t[o]=e.prototype;continue}}}return function(t){Object.keys(t).forEach(o=>{if(void 0===t[o])throw new TypeError(`Malformed intrinsic: ${o}`)})}(t),t}const u={\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",name:\\"string\\"},g=u,f={get:g,set:\\"undefined\\"};function P(t){return{\\"**proto**\\":\\"Error\\",prototype:t,length:\\"number\\",name:\\"string\\"}}function b(t){return{\\"**proto**\\":\\"ErrorPrototype\\",constructor:t,message:\\"string\\",name:\\"string\\",toString:g}}function m(t){return{\\"**proto**\\":\\"TypedArray\\",length:\\"number\\",name:\\"string\\",BYTES_PER_ELEMENT:\\"number\\",prototype:t}}function d(t){return{\\"**proto**\\":\\"TypedArrayPrototype\\",BYTES_PER_ELEMENT:\\"number\\",constructor:t}}var h=function(t){return(typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\")in new RegExp||delete t.RegExpStringIteratorPrototype,t}({\\"**proto**\\":null,ThrowTypeError:g,Infinity:\\"number\\",NaN:\\"number\\",undefined:\\"undefined\\",eval:g,isFinite:g,isNaN:g,parseFloat:g,parseInt:g,decodeURI:g,decodeURIComponent:g,encodeURI:g,encodeURIComponent:g,Object:{\\"**proto**\\":\\"FunctionPrototype\\",assign:g,create:g,defineProperties:g,defineProperty:g,entries:g,freeze:g,fromEntries:g,getOwnPropertyDescriptor:g,getOwnPropertyDescriptors:g,getOwnPropertyNames:g,getOwnPropertySymbols:g,getPrototypeOf:g,is:g,isExtensible:g,isFrozen:g,isSealed:g,keys:g,preventExtensions:g,prototype:\\"ObjectPrototype\\",seal:g,setPrototypeOf:g,values:g},ObjectPrototype:{\\"**proto**\\":null,constructor:\\"Object\\",hasOwnProperty:g,isPrototypeOf:g,propertyIsEnumerable:g,toLocaleString:g,toString:g,valueOf:g,__defineGetter__:g,__defineSetter__:g,__lookupGetter__:g,__lookupSetter__:g},Function:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},FunctionPrototype:{length:\\"number\\",name:\\"string\\",apply:g,bind:g,call:g,constructor:\\"FunctionPrototypeConstructor\\",toString:g,\\"@@hasInstance\\":g},Boolean:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"BooleanPrototype\\"},BooleanPrototype:{constructor:\\"Boolean\\",toString:g,valueOf:g},Symbol:{\\"**proto**\\":\\"FunctionPrototype\\",asyncIterator:\\"symbol\\",for:g,hasInstance:\\"symbol\\",isConcatSpreadable:\\"symbol\\",iterator:\\"symbol\\",keyFor:g,match:\\"symbol\\",matchAll:\\"symbol\\",prototype:\\"SymbolPrototype\\",replace:\\"symbol\\",search:\\"symbol\\",species:\\"symbol\\",split:\\"symbol\\",toPrimitive:\\"symbol\\",toStringTag:\\"symbol\\",unscopables:\\"symbol\\"},SymbolPrototype:{constructor:\\"Symbol\\",description:f,toString:g,valueOf:g,\\"@@toPrimitive\\":g,\\"@@toStringTag\\":\\"string\\"},Error:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"ErrorPrototype\\",captureStackTrace:g,stackTraceLimit:\\"number\\"},ErrorPrototype:{constructor:\\"Error\\",message:\\"string\\",name:\\"string\\",toString:g},EvalError:P(\\"EvalErrorPrototype\\"),RangeError:P(\\"RangeErrorPrototype\\"),ReferenceError:P(\\"ReferenceErrorPrototype\\"),SyntaxError:P(\\"SyntaxErrorPrototype\\"),TypeError:P(\\"TypeErrorPrototype\\"),URIError:P(\\"URIErrorPrototype\\"),EvalErrorPrototype:b(\\"EvalError\\"),RangeErrorPrototype:b(\\"RangeError\\"),ReferenceErrorPrototype:b(\\"ReferenceError\\"),SyntaxErrorPrototype:b(\\"SyntaxError\\"),TypeErrorPrototype:b(\\"TypeError\\"),URIErrorPrototype:b(\\"URIError\\"),Number:{\\"**proto**\\":\\"FunctionPrototype\\",EPSILON:\\"number\\",isFinite:g,isInteger:g,isNaN:g,isSafeInteger:g,MAX_SAFE_INTEGER:\\"number\\",MAX_VALUE:\\"number\\",MIN_SAFE_INTEGER:\\"number\\",MIN_VALUE:\\"number\\",NaN:\\"number\\",NEGATIVE_INFINITY:\\"number\\",parseFloat:g,parseInt:g,POSITIVE_INFINITY:\\"number\\",prototype:\\"NumberPrototype\\"},NumberPrototype:{constructor:\\"Number\\",toExponential:g,toFixed:g,toLocaleString:g,toPrecision:g,toString:g,valueOf:g},BigInt:{\\"**proto**\\":\\"FunctionPrototype\\",asIntN:g,asUintN:g,prototype:\\"BigIntPrototype\\"},BigIntPrototype:{constructor:\\"BigInt\\",toLocaleString:g,toString:g,valueOf:g,\\"@@toStringTag\\":\\"string\\"},Math:{E:\\"number\\",LN10:\\"number\\",LN2:\\"number\\",LOG10E:\\"number\\",LOG2E:\\"number\\",PI:\\"number\\",SQRT1_2:\\"number\\",SQRT2:\\"number\\",\\"@@toStringTag\\":\\"string\\",abs:g,acos:g,acosh:g,asin:g,asinh:g,atan:g,atanh:g,atan2:g,cbrt:g,ceil:g,clz32:g,cos:g,cosh:g,exp:g,expm1:g,floor:g,fround:g,hypot:g,imul:g,log:g,log1p:g,log10:g,log2:g,max:g,min:g,pow:g,random:g,round:g,sign:g,sin:g,sinh:g,sqrt:g,tan:g,tanh:g,trunc:g},Date:{\\"**proto**\\":\\"FunctionPrototype\\",now:g,parse:g,prototype:\\"DatePrototype\\",UTC:g},DatePrototype:{constructor:\\"Date\\",getDate:g,getDay:g,getFullYear:g,getHours:g,getMilliseconds:g,getMinutes:g,getMonth:g,getSeconds:g,getTime:g,getTimezoneOffset:g,getUTCDate:g,getUTCDay:g,getUTCFullYear:g,getUTCHours:g,getUTCMilliseconds:g,getUTCMinutes:g,getUTCMonth:g,getUTCSeconds:g,setDate:g,setFullYear:g,setHours:g,setMilliseconds:g,setMinutes:g,setMonth:g,setSeconds:g,setTime:g,setUTCDate:g,setUTCFullYear:g,setUTCHours:g,setUTCMilliseconds:g,setUTCMinutes:g,setUTCMonth:g,setUTCSeconds:g,toDateString:g,toISOString:g,toJSON:g,toLocaleDateString:g,toLocaleString:g,toLocaleTimeString:g,toString:g,toTimeString:g,toUTCString:g,valueOf:g,\\"@@toPrimitive\\":g,getYear:g,setYear:g,toGMTString:g},String:{\\"**proto**\\":\\"FunctionPrototype\\",fromCharCode:g,fromCodePoint:g,prototype:\\"StringPrototype\\",raw:g},StringPrototype:{length:\\"number\\",charAt:g,charCodeAt:g,codePointAt:g,concat:g,constructor:\\"String\\",endsWith:g,includes:g,indexOf:g,lastIndexOf:g,localeCompare:g,match:g,matchAll:g,normalize:g,padEnd:g,padStart:g,repeat:g,replace:g,search:g,slice:g,split:g,startsWith:g,substring:g,toLocaleLowerCase:g,toLocaleUpperCase:g,toLowerCase:g,toString:g,toUpperCase:g,trim:g,trimEnd:g,trimStart:g,valueOf:g,\\"@@iterator\\":g,substr:g,anchor:g,big:g,blink:g,bold:g,fixed:g,fontcolor:g,fontsize:g,italics:g,link:g,small:g,strike:g,sub:g,sup:g,trimLeft:g,trimRight:g},StringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},RegExp:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"RegExpPrototype\\",\\"@@species\\":f},RegExpPrototype:{constructor:\\"RegExp\\",exec:g,dotAll:f,flags:f,global:f,ignoreCase:f,\\"@@match\\":g,\\"@@matchAll\\":g,multiline:f,\\"@@replace\\":g,\\"@@search\\":g,source:f,\\"@@split\\":g,sticky:f,test:g,toString:g,unicode:f,compile:!1},RegExpStringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Array:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,isArray:g,of:g,prototype:\\"ArrayPrototype\\",\\"@@species\\":f},ArrayPrototype:{length:\\"number\\",concat:g,constructor:\\"Array\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,flat:g,flatMap:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,map:g,pop:g,push:g,reduce:g,reduceRight:g,reverse:g,shift:g,slice:g,some:g,sort:g,splice:g,toLocaleString:g,toString:g,unshift:g,values:g,\\"@@iterator\\":g,\\"@@unscopables\\":{\\"**proto**\\":null,copyWithin:\\"boolean\\",entries:\\"boolean\\",fill:\\"boolean\\",find:\\"boolean\\",findIndex:\\"boolean\\",flat:\\"boolean\\",flatMap:\\"boolean\\",includes:\\"boolean\\",keys:\\"boolean\\",values:\\"boolean\\"}},ArrayIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},TypedArray:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,of:g,prototype:\\"TypedArrayPrototype\\",\\"@@species\\":f},TypedArrayPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"TypedArray\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,length:f,map:g,reduce:g,reduceRight:g,reverse:g,set:g,slice:g,some:g,sort:g,subarray:g,toLocaleString:g,toString:g,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":f},BigInt64Array:m(\\"BigInt64ArrayPrototype\\"),BigUint64Array:m(\\"BigUint64ArrayPrototype\\"),Float32Array:m(\\"Float32ArrayPrototype\\"),Float64Array:m(\\"Float64ArrayPrototype\\"),Int16Array:m(\\"Int16ArrayPrototype\\"),Int32Array:m(\\"Int32ArrayPrototype\\"),Int8Array:m(\\"Int8ArrayPrototype\\"),Uint16Array:m(\\"Uint16ArrayPrototype\\"),Uint32Array:m(\\"Uint32ArrayPrototype\\"),Uint8Array:m(\\"Uint8ArrayPrototype\\"),Uint8ClampedArray:m(\\"Uint8ClampedArrayPrototype\\"),BigInt64ArrayPrototype:d(\\"BigInt64Array\\"),BigUint64ArrayPrototype:d(\\"BigUint64Array\\"),Float32ArrayPrototype:d(\\"Float32Array\\"),Float64ArrayPrototype:d(\\"Float64Array\\"),Int16ArrayPrototype:d(\\"Int16Array\\"),Int32ArrayPrototype:d(\\"Int32Array\\"),Int8ArrayPrototype:d(\\"Int8Array\\"),Uint16ArrayPrototype:d(\\"Uint16Array\\"),Uint32ArrayPrototype:d(\\"Uint32Array\\"),Uint8ArrayPrototype:d(\\"Uint8Array\\"),Uint8ClampedArrayPrototype:d(\\"Uint8ClampedArray\\"),Map:{\\"**proto**\\":\\"FunctionPrototype\\",\\"@@species\\":f,prototype:\\"MapPrototype\\"},MapPrototype:{clear:g,constructor:\\"Map\\",delete:g,entries:g,forEach:g,get:g,has:g,keys:g,set:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},MapIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Set:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"SetPrototype\\",\\"@@species\\":f},SetPrototype:{add:g,clear:g,constructor:\\"Set\\",delete:g,entries:g,forEach:g,has:g,keys:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},SetIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},WeakMap:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakMapPrototype\\"},WeakMapPrototype:{constructor:\\"WeakMap\\",delete:g,get:g,has:g,set:g,\\"@@toStringTag\\":\\"string\\"},WeakSet:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakSetPrototype\\"},WeakSetPrototype:{add:g,constructor:\\"WeakSet\\",delete:g,has:g,\\"@@toStringTag\\":\\"string\\"},ArrayBuffer:{\\"**proto**\\":\\"FunctionPrototype\\",isView:g,prototype:\\"ArrayBufferPrototype\\",\\"@@species\\":f},ArrayBufferPrototype:{byteLength:f,constructor:\\"ArrayBuffer\\",slice:g,\\"@@toStringTag\\":\\"string\\"},SharedArrayBuffer:!1,DataView:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"DataViewPrototype\\"},DataViewPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"DataView\\",getBigInt64:g,getBigUint64:g,getFloat32:g,getFloat64:g,getInt8:g,getInt16:g,getInt32:g,getUint8:g,getUint16:g,getUint32:g,setBigInt64:g,setBigUint64:g,setFloat32:g,setFloat64:g,setInt8:g,setInt16:g,setInt32:g,setUint8:g,setUint16:g,setUint32:g,\\"@@toStringTag\\":\\"string\\"},Atomics:!1,JSON:{parse:g,stringify:g,\\"@@toStringTag\\":\\"string\\"},IteratorPrototype:{\\"@@iterator\\":g},AsyncIteratorPrototype:{\\"@@asyncIterator\\":g},GeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"Generator\\"},Generator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"GeneratorFunction\\",prototype:\\"GeneratorPrototype\\"},AsyncGeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncGenerator\\"},AsyncGenerator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncGeneratorFunction\\",prototype:\\"AsyncGeneratorPrototype\\",\\"@@toStringTag\\":\\"string\\"},GeneratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",constructor:\\"Generator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},AsyncGeneratorPrototype:{\\"**proto**\\":\\"AsyncIteratorPrototype\\",constructor:\\"AsyncGenerator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},Promise:{\\"**proto**\\":\\"FunctionPrototype\\",all:g,allSettled:g,prototype:\\"PromisePrototype\\",race:g,reject:g,resolve:g,\\"@@species\\":f},PromisePrototype:{catch:g,constructor:\\"Promise\\",finally:g,then:g,\\"@@toStringTag\\":\\"string\\"},AsyncFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncFunctionPrototype\\"},AsyncFunctionPrototype:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncFunction\\",\\"@@toStringTag\\":\\"string\\"},Reflect:{apply:g,construct:g,defineProperty:g,deleteProperty:g,get:g,getOwnPropertyDescriptor:g,getPrototypeOf:g,has:g,isExtensible:g,ownKeys:g,preventExtensions:g,set:g,setPrototypeOf:g},Proxy:{\\"**proto**\\":\\"FunctionPrototype\\",revocable:g},escape:g,unescape:g,FunctionPrototypeConstructor:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},Compartment:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"CompartmentPrototype\\"},CompartmentPrototype:{constructor:\\"Compartment\\",evaluate:g,global:f},harden:g});const{getPrototypeOf:A,getOwnPropertyDescriptor:E}=Object,{apply:S,ownKeys:_}=Reflect,w=(t=>(o,...r)=>S(t,o,r))(Object.prototype.hasOwnProperty);function I(t,o){if(\\"string\\"==typeof o)return o;if(\\"symbol\\"==typeof o)return`@@${o.toString().slice(14,-1)}`;throw new TypeError(`Unexpected property name type ${t} ${o}`)}function F(t){const o=[\\"undefined\\",\\"boolean\\",\\"number\\",\\"string\\",\\"symbol\\"];function r(r,e,n,i){if(\\"object\\"==typeof i)return a(r,e,i),!0;if(!1===i)return!1;if(\\"string\\"==typeof i)if(\\"prototype\\"===n||\\"constructor\\"===n){if(w(t,i))return e===t[i]}else if(o.includes(i))return typeof e===i;throw new TypeError(`Unexpected whitelist permit ${r}`)}function e(t,o,e,n){const a=E(o,e);return w(a,\\"value\\")?r(t,a.value,e,n):r(`${t}<get>`,a.get,e,n.get)&&r(`${t}<set>`,a.set,e,n.set)}function n(t,o){return w(t,o)?t[o]:\\"FunctionPrototype\\"===t[\\"**proto**\\"]&&w(u,o)?u[o]:void 0}function a(o,r,a){!function(o,r,e){const n=A(r);if(null!==n||null!==e){if(void 0!==e&&\\"string\\"!=typeof e)throw new TypeError(`Malformed whitelist permit ${o}.__proto__`);if(n!==t[e||\\"ObjectPrototype\\"])throw new Error(`Unexpected intrinsic ${o}.__proto__`)}}(o,r,a[\\"**proto**\\"]);for(const t of _(r)){if(\\"__proto__\\"===t)continue;const i=I(o,t),c=`${o}.${i}`,p=n(a,i);if(!p||!e(c,r,t,p))try{delete r[t]}catch(t){}}}a(\\"intrinsics\\",t,h)}const{defineProperties:T,getOwnPropertyDescriptors:v}=Object;const{getOwnPropertyDescriptor:O}=Object;const{defineProperties:U,getOwnPropertyDescriptors:x,getOwnPropertyDescriptor:R}=Object;const C=!0;var M={ObjectPrototype:\\"*\\",ArrayPrototype:\\"*\\",FunctionPrototype:{constructor:C,bind:C,name:C,toString:C},ErrorPrototype:{constructor:C,message:C,name:C},PromisePrototype:{constructor:C},TypedArrayPrototype:\\"*\\",Generator:{constructor:C,name:C,toString:C},IteratorPrototype:\\"*\\"};const{defineProperties:j,getOwnPropertyNames:G,getOwnPropertyDescriptor:k,getOwnPropertyDescriptors:N}=Object,{ownKeys:$}=Reflect;function D(t){return null!==t&&\\"object\\"==typeof t}const{assign:B,freeze:L,defineProperties:W,getOwnPropertyDescriptor:V,getOwnPropertyNames:z,getPrototypeOf:Y,setPrototypeOf:J,prototype:H}=Object,{apply:K,get:Q,set:X}=Reflect,{isArray:q,prototype:Z}=Array,{revocable:tt}=Proxy,{prototype:ot}=RegExp,{prototype:rt}=String,{prototype:et}=WeakMap,nt=t=>(o,...r)=>K(t,o,r),at=nt(H.hasOwnProperty),it=(nt(Z.filter),nt(Z.join)),ct=(nt(Z.push),nt(Z.pop)),pt=nt(Z.includes),st=nt(ot.test),yt=(nt(rt.match),nt(rt.search)),lt=nt(rt.slice),ut=nt(rt.split),gt=(nt(et.get),nt(et.set),nt(et.has),t=>Q(Y(t),\\"constructor\\")),ft=L({__proto__:null});function Pt(t,o){const r=`please report internal shim error: ${t}`;throw console.error(r),o&&(console.error(`${o}`),console.error(`${o.stack}`)),TypeError(r)}function bt(t,o){t||Pt(o)}const mt=[\\"await\\",\\"break\\",\\"case\\",\\"catch\\",\\"class\\",\\"const\\",\\"continue\\",\\"debugger\\",\\"default\\",\\"delete\\",\\"do\\",\\"else\\",\\"export\\",\\"extends\\",\\"finally\\",\\"for\\",\\"function\\",\\"if\\",\\"import\\",\\"in\\",\\"instanceof\\",\\"new\\",\\"return\\",\\"super\\",\\"switch\\",\\"this\\",\\"throw\\",\\"try\\",\\"typeof\\",\\"var\\",\\"void\\",\\"while\\",\\"with\\",\\"yield\\",\\"let\\",\\"static\\",\\"enum\\",\\"implements\\",\\"package\\",\\"protected\\",\\"interface\\",\\"private\\",\\"public\\",\\"await\\",\\"null\\",\\"true\\",\\"false\\",\\"this\\",\\"arguments\\"],dt=new RegExp(\\"^[a-zA-Z_$][\\\\\\\\w$]*$\\");function ht(t){return\\"eval\\"!==t&&!pt(mt,t)&&st(dt,t)}function At(t,o){const r=V(t,o);return(!1===r.configurable&&!1===r.writable&&at(r,\\"value\\"))}const Et=new Proxy(ft,{get(t,o){Pt(`unexpected scope handler trap called: ${String(o)}`)}});function St(t,o){const r=yt(t,o);return r<0?-1:ut(lt(t,0,r),\\"\\\\n\\").length}const _t=new RegExp(\\"(?:\\\\x3c!--|--\\\\x3e)\\");const wt=new RegExp(\\"\\\\\\\\bimport\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const It=new RegExp(\\"\\\\\\\\beval\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const Ft={rewrite:t=>(function(t){const o=St(t,_t);if(o<0)return t;throw new SyntaxError(`possible html comment syntax rejected around line ${o}`)}(t.src),function(t){const o=St(t,wt);if(o<0)return t;throw new SyntaxError(`possible import expression rejected around line ${o}`)}(t.src),function(t){const o=St(t,It);if(o<0)return t;throw new SyntaxError(`possible direct eval expression rejected around line ${o}`)}(t.src),t)};function Tt(t,o=[]){const r=function(t){return 0===t.length?\\"\\":`const {${it(t,\\",\\")}} = this;`}(o);return t.intrinsics.Function(`\\\\n    with (this) {\\\\n      ${r}\\\\n      return function() {\\\\n        \'use strict\';\\\\n        return eval(arguments[0]);\\\\n      };\\\\n    }\\\\n  `)}function vt(t,o,r,e={},{localTransforms:n=[],globalTransforms:a=[],sloppyGlobalsMode:i=!1}={}){let c={src:o,endowments:e};c=function(t,o){for(const r of o)\\"function\\"==typeof r.rewrite&&(t=r.rewrite(t));return t}(c,[...n,...a,Ft]);const p=function(t,o,r={},{sloppyGlobalsMode:e=!1}={}){return{__proto__:Et,useUnsafeEvaluator:!1,get(e,n){if(\\"symbol\\"!=typeof n)return\\"eval\\"===n&&!0===this.useUnsafeEvaluator?(this.useUnsafeEvaluator=!1,t.intrinsics.eval):n in r?Q(r,n,o):Q(o,n)},set(t,e,n){if(e in r){return\\"value\\"in V(r,e)?X(r,e,n):X(r,e,n,o)}return X(o,e,n)},has:(t,n)=>!!(e||\\"eval\\"===n||n in r||n in o||n in globalThis),getPrototypeOf:()=>null}}(t,r,c.endowments,{sloppyGlobalsMode:i}),s=tt(ft,p),y=Tt(t,function(t,o={}){const r=z(t),e=z(o),n=e.filter(t=>ht(t)&&At(o,t));return[...r.filter(o=>!e.includes(o)&&ht(o)&&At(t,o)),...n]}(r,c.endowments)),l=K(y,s.proxy,[]);let u;p.useUnsafeEvaluator=!0;try{return K(l,r,[c.src])}catch(t){throw u=t,t}finally{!0===p.useUnsafeEvaluator&&(Pt(\\"handler did not revoke useUnsafeEvaluator\\",u),s.revoke())}}const Ot=(t,o,r={})=>{const e=e=>\\"string\\"!=typeof e?e:vt(t,e,o,{},r);return W(e,{toString:{value:()=>\\"function eval() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(gt(e)!==Function,\\"eval constructor is Function\\"),bt(gt(e)!==t.intrinsics.Function,\\"eval contructions is %Function%\\"),e};function Ut(t,o,r={}){const e=function(e){const n=`${ct(arguments)||\\"\\"}`,a=`${it(arguments,\\",\\")}`;new t.intrinsics.Function(a,n);const i=`(function anonymous(${a}\\\\n) {\\\\n${n}\\\\n})`;return vt(t,i,o,{},r)};return W(e,{prototype:{value:t.intrinsics.Function.prototype,writable:!1,enumerable:!1,configurable:!1},toString:{value:()=>\\"function Function() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(Y(Function)===Function.prototype),bt(Y(e)===Function.prototype),bt(gt(e)!==Function),bt(gt(e)!==t.intrinsics.Function),e}const xt=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];const{getOwnPropertyDescriptor:Rt}=Object,Ct=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];let Mt;function jt(){if(Mt)return Mt;const t=function(){const t={__proto__:null};for(const o of Ct){const r=Rt(globalThis,o);if(r){if(\\"get\\"in r||\\"set\\"in r)throw new TypeError(`Unexpected accessor on global property: ${o}`);t[o]=r.value}}return t}();return Mt={__proto__:null,intrinsics:t},L(Mt)}const Gt=new WeakMap;class kt{constructor(t,o,r={}){const{transforms:e=[]}=r,n=[...e],a=function(t,{globalTransforms:o}){const r={},e={Infinity:{value:1/0,enumerable:!1},NaN:{value:NaN,enumerable:!1},undefined:{value:void 0,enumerable:!1}};for(const n of xt){if(!at(t.intrinsics,n))continue;let a;switch(n){case\\"eval\\":a=Ot(t,r,{globalTransforms:o});break;case\\"Function\\":a=Ut(t,r,{globalTransforms:o});break;case\\"globalThis\\":a=r;break;default:a=t.intrinsics[n]}e[n]={value:a,configurable:!0,writable:!0,enumerable:!1}}return W(r,e),bt(r.eval!==t.intrinsics.eval,\\"eval on global object\\"),bt(r.Function!==t.intrinsics.Function,\\"Function on global object\\"),r}(jt(),{globalTransforms:n});B(a,t),Gt.set(this,{globalTransforms:n,globalObject:a})}get global(){return Gt.get(this).globalObject}evaluate(t,o={}){if(\\"string\\"!=typeof t)throw new TypeError(\\"first argument of evaluate() must be a string\\");const{endowments:r={},transforms:e=[],sloppyGlobalsMode:n=!1}=o,a=[...e],{globalTransforms:i,globalObject:c}=Gt.get(this);return vt(jt(),t,c,r,{globalTransforms:i,localTransforms:a,sloppyGlobalsMode:n})}toString(){return\\"[object Compartment]\\"}static toString(){return\\"function Compartment() { [shim code] }\\"}}let Nt;function $t(t,o){if(!t)throw new TypeError(o)}\\"object\\"!=typeof globalThis&&(Object.prototype.__defineGetter__(\\"__magic__\\",(function(){return this})),__magic__.globalThis=__magic__,delete Object.prototype.__magic__),t.lockdown=function(t={}){const{noTameDate:o=!1,noTameError:r=!1,noTameMath:e=!1,noTameRegExp:n=!1,registerOnly:a=!1,...i}=t,c=Object.keys(i);$t(0===c.length,`lockdown(): non supported option ${c.join(\\", \\")}`);const p={noTameDate:o,noTameError:r,noTameMath:e,noTameRegExp:n,registerOnly:a};if(Nt)return Object.keys(p).forEach(t=>{$t(p[t]===Nt[t],`lockdown(): cannot re-invoke with different option ${t}`)}),!1;Nt=p,function(){try{(0,Function.prototype.constructor)(\\"return 1\\")}catch(t){return}const{defineProperties:t,getPrototypeOf:o,setPrototypeOf:r}=Object;function e(e,n){let a;try{a=(0,eval)(n)}catch(t){if(t instanceof SyntaxError)return;throw t}const i=o(a),c=function(){throw new TypeError(\\"Not available\\")};t(c,{name:{value:e,writable:!1,enumerable:!1,configurable:!0},toString:{value:()=>`function ${e}() { [native code] }`,writable:!1,enumerable:!1,configurable:!0}}),t(i,{constructor:{value:c}}),t(c,{prototype:{value:i}}),c!==Function.prototype.constructor&&r(c,Function.prototype.constructor)}e(\\"Function\\",\\"(function(){})\\"),e(\\"GeneratorFunction\\",\\"(function*(){})\\"),e(\\"AsyncFunction\\",\\"(async function(){})\\"),e(\\"AsyncGeneratorFunction\\",\\"(async function*(){})\\")}(),o||function(){const t={now:()=>NaN};Date.now=t.now;const o={toLocaleString:()=>NaN};Date.prototype.toLocaleString=o.toLocaleString;const r=Date,e=function(){return void 0===new.target?\\"Invalid Date\\":arguments.length>0?Reflect.construct(r,arguments,new.target):Reflect.construct(r,[NaN],new.target)},n=v(r);T(e,n);const a=v(r.prototype);a.constructor.value=e,T(e.prototype,a),globalThis.Date=e;const i={toLocaleString(){throw new TypeError(\\"Object.prototype.toLocaleString is disabled\\")}};Object.prototype.toLocaleString=i.toLocaleString}(),r||function(){if(delete Error.captureStackTrace,O(Error,\\"captureStackTrace\\"))throw Error(\\"Cannot remove Error.captureStackTrace\\");if(delete Error.stackTraceLimit,O(Error,\\"stackTraceLimit\\"))throw Error(\\"Cannot remove Error.stackTraceLimit\\")}(),e||function(){const t={random(){throw TypeError(\\"Math.random() is disabled\\")}};Math.random=t.random}(),n||function(){delete RegExp.prototype.compile;const t=RegExp,o=function(){return Reflect.construct(t,arguments,new.target)},r=R(t,Symbol.species);U(o,Symbol.species,r);const e=x(t.prototype);e.constructor.value=o,U(o.prototype,e),globalThis.RegExp=o}();const s=function(t,o={}){const{freeze:r,getOwnPropertyDescriptors:e,getPrototypeOf:n}=Object,{ownKeys:a}=Reflect;let{fringeSet:i}=o;if(i){if(\\"function\\"!=typeof i.add||\\"function\\"!=typeof i.has)throw new TypeError(\\"options.fringeSet must have add() and has() methods\\");if(t)for(const o of t)i.add(o)}else i=new WeakSet(t);const c=o&&o.naivePrepareObject,{harden:p}={harden(t){const o=new Set,p=new Map,s=new WeakMap;function y(t,r){if(Object(t)!==t)return;const e=typeof t;if(\\"object\\"!==e&&\\"function\\"!==e)throw new TypeError(`Unexpected typeof: ${e}`);i.has(t)||o.has(t)||(o.add(t),s.set(t,r))}function l(t){c&&c(t),r(t);const o=n(t),i=e(t),l=s.get(t)||\\"unknown\\";null===o||p.has(o)||(p.set(o,l),s.set(o,`${l}.__proto__`)),a(i).forEach(t=>{const o=`${l}.${String(t)}`,r=i[t];\\"value\\"in r?y(r.value,`${o}`):(y(r.get,`${o}(get)`),y(r.set,`${o}(set)`))})}return y(t),o.forEach(l),p.forEach((t,r)=>{if(!o.has(r)&&!i.has(r)){let o;try{o=`prototype ${r} of ${t} is not already in the fringeSet`}catch(e){o=\\"a prototype of something is not already in the fringeset (and .toString failed)\\";try{console.log(o),console.log(\\"the prototype:\\",r),console.log(\\"of something:\\",t)}catch(t){}}throw new TypeError(o)}}),o.forEach(i.add,i),t}};return p}();Object.defineProperties(globalThis,{harden:{value:s,configurable:!0,writable:!0,enumerable:!1},Compartment:{value:kt,configurable:!0,writable:!0,enumerable:!1}});const y=l();F(y),function(){try{(0,Object.prototype.__lookupGetter__)(\\"x\\")}catch(t){return}const{defineProperty:t,defineProperties:o,getOwnPropertyDescriptor:r,getPrototypeOf:e,prototype:n}=Object;function a(t){if(null==t)throw new TypeError(\\"can\'t convert undefined or null to object\\");return Object(t)}function i(t){return\\"symbol\\"==typeof t?t:`${t}`}function c(t,o){if(\\"function\\"!=typeof t)throw TypeError(`invalid ${o} usage`);return t}o(n,{__defineGetter__:{value:function(o,r){const e=a(this);t(e,o,{get:c(r,\\"getter\\"),enumerable:!0,configurable:!0})}},__defineSetter__:{value:function(o,r){const e=a(this);t(e,o,{set:c(r,\\"setter\\"),enumerable:!0,configurable:!0})}},__lookupGetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.get}},__lookupSetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.set}}})}();const u=function(t){const o={};function r(t,r,e,n){if(\\"value\\"in n&&n.configurable){const{value:a}=n;o[t]=a,j(r,{[e]:{get:function(){return a},set:function(o){if(r===this)throw new TypeError(`Cannot assign to read only property \'${e}\' of \'${t}\'`);hasOwnProperty.call(this,e)?this[e]=o:j(this,{[e]:{value:o,writable:!0,enumerable:n.enumerable,configurable:n.configurable}})},enumerable:n.enumerable,configurable:n.configurable}})}}function e(t,o,e){const n=k(o,e);n&&r(t,o,e,n)}function n(t,o){const e=N(o);e&&$(e).forEach(n=>r(t,o,n,e[n]))}return function t(o,r,a){for(const i of G(a)){const c=k(r,i);if(!c||c.get||c.set)continue;const p=`${o}.${i}`,s=a[i];if(!0===s)e(p,r,i);else if(\\"*\\"===s)n(p,c.value);else{if(!D(s))throw new TypeError(`Unexpected override enablement plan ${p}`);t(p,c.value,s)}}}(\\"root\\",t,M),o}(y);return s(y,a),s(u,a),!0},Object.defineProperty(t,\\"__esModule\\",{value:!0})}));\\n"')},function(t,e){t.exports={makeDeterministic:function(){const t=(t,e)=>{if(t===e)return 0;if(void 0===t)return 1;if(void 0===e)return-1;const r=null===t?"null":t.toString(),n=null===e?"null":e.toString();return r<n?-1:r>n?1:0},e=Array.prototype.sort;Array.prototype.sort=function(r=t){const n=new Map;return this.forEach((t,e)=>n.set(t,e)),e.call(this,(t,e)=>{const o=r(t,e);return 0!==o?o:n.get(t)-n.get(e)})},delete String.prototype.localeCompare;const r=Function.prototype.toString;Function.prototype.toString=function(){const t=r.call(this),e=t.match(/^([a-zA-Z0-9_$]+)\s*\(/);return e&&"function"!==e[1]?"function "+t:t}},nonDeterministicIntrinsics:["Date","Math","eval","XMLHttpRequest","FileReader","WebSocket","setTimeout","setInterval"]}}])},function(t,e,r){const{JigControl}=r(3),{j:n,R:o}=r(0),{Kt:i}=r(8),s=r(32),c=r(1),a=r(5);t.exports=class{constructor(t){this.It=t,this.cr=[],this.Ge=new Map,this.ar=[],this.ur=new s}hr(t){if(!t.Pe()){for(const[e,r]of t.de)this.Ge.has(e)||this.Ge.set(e,r);this.cr.push(t),1===this.cr.length&&this.lr().catch(t=>{})}}async Qe(){if(this.cr.length)return new Promise((t,e)=>{this.ar.push({resolve:t,reject:e})})}async lr(){const t=this.cr[0];let e=null;try{e=await this.pr(t)}catch(t){return void this.yr(t)}this.gr(t,e),await this.dr(t,e),this.wr(t),this.cr.shift(),this.cr.length?this.lr().catch(t=>{}):(this.ar.forEach(t=>t.resolve()),this.ar=[])}async pr(t){const e=t.Ne(this.It);let r=null;const{refs:n,No:o,Mo:i}=e;r=e.tx;const s=n.map(t=>t.slice(0,64)),c=n.map(t=>parseInt(t.slice(66)));(s.length?await Promise.all(s.map(t=>this.It.Ee.fetch(t))):[]).forEach((t,e)=>{if(void 0===t.outputs[c[e]].spentTxId)throw new Error(`Read ${n[e]} may not be latest. Blockchain did not return spentTxId. Aborting.`);if(null!==t.outputs[c[e]].spentTxId)throw new Error(`Read ${n[e]} is not the latest. Must sync() jigs`)}),t._e||await t.Ue(this.It),await t.Be(this.It),r=t.Ne(this.It).tx;for(let t=0;t<o.length;t++)if(!r.inputs[t].isFullySigned()){const e=`${"origin: "+o[t].origin}\n${"location: "+i[t]}\n${"owner: "+o[t].owner}`,n=r.inputs[t].script.toBuffer().length?"Bad signature":"Missing signature";throw new Error(`${n} for ${o[t].constructor.name}\n\n${e}`)}try{"function"==typeof this.It.Ce.broadcast&&await this.It.Ce.broadcast(r),await this.It.Ee.broadcast(r)}catch(t){throw await this.br(t,r)}return this.ur._r(r),r}async br(t,e){const r=t.toString();let n="Broadcast failed: "+t.message;if(-1!==r.indexOf("tx has no inputs")||-1!==r.indexOf("tx fee too low")){n=`${n}\n\n${"Hint: Is the purse funded to pay for this transaction?"}`}if(-1!==r.indexOf("Missing inputs")||-1!==r.indexOf("txn-mempool-conflict"))for(const r of e.inputs){const e=r.prevTxId.toString("hex");let o=null;try{o=await this.It.Ee.fetch(e,!0)}catch(t){continue}const s=o.outputs[r.outputIndex];if(s.spentTxId){const c=`${e}_o${r.outputIndex}`;let a="Payment";switch(i(o,r.outputIndex)){case"code":try{a=(await this.It.Ye(c)).name}catch(t){a="Code"}break;case"jig":try{a=""+await this.It.Ye(c)}catch(t){a="Jig"}}n=`${n}\n\n${a} was spent in another transaction\n`,n=`${n}\nLocation: ${c}`,n=`${n}\nSpending Tx: ${s.spentTxId}`}}return new Error(n)}gr(t,e){const r=t=>this.cr.slice(1).some(e=>e.ge.some(e=>o(t,e)));t.ge.forEach((n,o)=>{const i=1+t.he.length+o;"_"===n.origin[0]&&(n.origin=`${e.hash}_o${i}`),r(n)?this.Ge.set(n.origin,`${e.hash}_o${i}`):(n.location=`${e.hash}_o${i}`,this.Ge.delete(n.origin)),t.pe.get(n).restore().origin=n.origin,t.pe.get(n).restore().location=`${e.hash}_o${i}`}),t.he.forEach((t,r)=>t.success(`${e.hash}_o${r+1}`))}async dr(t,e){for(const r of t.ge){const o=t.pe.get(r).restore(),i=o.location;o.origin.startsWith(e.hash)&&delete o.origin,o.location.startsWith(e.hash)&&delete o.location;const s=JigControl.g(()=>a.et(o,{K:a.q.Ct(a.q.V(a.q.Y(t=>{const r=this.Ge.get(t.origin)||t.location;return r.startsWith(e.hash)?r.slice(64):r}),a.q.Z()))})),c=n(this.It.Ee.network);let u=r.constructor["origin"+c];u.startsWith(e.hash)&&(u=u.slice(64));const f={type:u,state:s};await this.It.Te.set(i,f)}}wr(t){const e=this.It.$e;t.he.forEach(t=>e.je(t.S)),t.ge.forEach(r=>e.je(t.dt.get(r)))}yr(t){const e=0===this.ar.length,r=[];for(let n=this.cr.length-1;n>=0;n--)try{this.cr[n].Fe(this.Ge,this.It,t,e)}catch(t){r.push(t)}let n=t.toString();r.length&&(n+="These errors also occurred while rolling back:",r.forEach(t=>{n+="\n\n"+t.toString()}));const o=new Error(n);e&&c.ut("Publisher","Unhandled",o),this.ar.forEach(t=>t.reject(o)),this.ar=[],this.cr=[],this.Ge=new Map}}},function(t,e){class r{constructor(t){this.mr=t}Pr(){this.mr.vr.delete(this)}}t.exports=class{constructor(){this.vr=new Map}_r(t){for(const e of this.vr.values())e(t)}Er(t){const e=new r(this);return this.vr.set(e,t),e}}},function(t,e,r){const n=r(20),{JigControl}=r(3),o=r(6),{C:i,k:s}=r(0),c=r(1);t.exports=class{constructor(t){this.It=t}async xt(t,e){c.ct("Syncer","Syncing");const r=void 0===e||e,n=new Set,o=this.It.Le,i=o.ur.Er(t=>n.add(t.hash));try{await o.Qe()}catch(e){if(r)try{await this.Or(t,n)}catch(t){}throw e}finally{i.Pr()}return r&&await this.Or(t,n),t}async Or(t,e=new Set,r=new Map){const n=r.get(t.origin);if(n)return JigControl.g(()=>JigControl.$t(()=>{Object.assign(t,n)}));let i=o.parse(t.location),s=await this.It.Ee.fetch(i.txid,!e.has(i.txid));for(e.add(i.txid);null!==s.outputs[i.vout].spentTxId;)s=await this.Sr(s,i.vout,e),await this.Ar(t,s),i=o.parse(t.location);return r.set(t.origin,t),await this.xr(t,e,r),t}async Sr(t,e,r){const n=t.outputs[e];if(void 0===n.spentTxId){throw new Error(`${"Failed to forward sync jig"}\n\n${"The blockchain API does not support the spentTxId field."}\n\n${"Hint: To just publish updates without forward sync, use `jig.sync({ forward: false })`."}`)}const o=await this.It.Ee.fetch(n.spentTxId,!r.has(n.spentTxId));if(r.add(n.spentTxId),!o.inputs.some(r=>r.prevTxId.toString("hex")===t.hash&&r.outputIndex===e)){const e="Blockchain API returned an incorrect spentTxId",r=`Txid: ${t.hash}\nSpent Txid: ${n.spentTxId}`;throw new Error(`${e}\n\n${r}\n\n${"Hint: Check that the blockchain API is working correctly"}`)}return o}async Ar(t,e){const r=new n;if(await r.ve(e,this.It,t,!0),!Array.from(r.dt.values()).some(e=>e===t)){const r="Expected but did not find a jig in its spent transaction",n=`Jig origin: ${t.origin}\nTxid: ${e.hash}`;throw new Error(`${r}\n\n${n}\n\n${"This is an internal Run bug. Please report it to the library developers."}`)}}async xr(t,e,r){const n=[];JigControl.g(()=>{i(t,t=>("jig"===s(t)&&n.push(t),!0))});for(const t of n)await this.Or(t,e,r)}}},function(t,e,r){const n=r(2),{JigControl}=r(3),{ResourceSet:o,Zt:i}=r(7),{k:s,L:c,F:a}=r(0),u=r(1),f="Inventory";function h(t){return JigControl.g(()=>{try{return"!"===t.location[0]}catch(t){return!0}})}t.exports=class{constructor(t){this.It=t,this.De=t.De,this.Tr=null,this.Y=new o}get jigs(){return this.resources.filter(t=>"jig"===s(t))}get code(){return this.resources.filter(t=>"code"===s(t))}get resources(){const t=[],e=[];for(const r of this.Y.values())h(r)||!this.Bo(r)?e.push(r):t.push(r);return i(()=>{e.forEach(t=>{this.Y.delete(t)&&u.ct(f,"Removed",a(t))})}),t}async sync(){return this.Tr||(this.Tr=this.Ir().then(()=>{this.Tr=null}).catch(t=>{throw this.Tr=null,t})),this.Tr}async Ir(){const t=[],e=(Array.isArray(this.De.owner)?this.De.owner:[this.De.owner]).map(async e=>{const r=new n.Script(n.deps.Buffer.from(c(e).script));(await this.It.Ee.utxos(r)).forEach(e=>t.push(`${e.txid}_o${e.vout}`))});await Promise.all(e);const r=new Set(t),o=[],s=[];JigControl.g(()=>{for(const t of this.Y.values())t.location.startsWith("_")?s.push(t):h(t)||!this.Bo(t)?o.push(t):r.has(t.location)?s.push(t):o.push(t)}),i(()=>{o.forEach(t=>{this.Y.delete(t)&&u.ct(f,"Removed",a(t))})});const l=new Set(JigControl.g(()=>s.map(t=>t.location)));for(const e of t){if(l.has(e))continue;let t=null;try{t=await this.It.Ye(e)}catch(t){u.ut(f,`Failed to load owner location ${e}\n\n${t.toString()}`);continue}i(()=>{const e=this.Y.has(t);this.Y.add(t),e||u.ct(f,"Added",a(t))})}}je(t){i(()=>{const e=this.Y.has(t);this.Y.delete(t),this.Bo(t)?(this.Y.add(t),e||u.ct(f,"Added",a(t))):e&&u.ct(f,"Removed",a(t))})}Bo(t){try{const e=(Array.isArray(this.De.owner)?this.De.owner:[this.De.owner]).map(t=>c(t)),r=c(t.owner);return e.some(t=>function(t,e){if(t.script.length!==e.script.length)return!1;for(let r=0;r<t.script.length;r++)if(t.script[r]!==e.script[r])return!1;return!0}(t,r))}catch(t){return!1}}}},function(t,e,r){const{JigControl}=r(3),n=r(6),{oe:o}=r(10),i=r(5),s=r(1),c=r(20),{A:a}=r(0),{Kt:u}=r(8),f="Transaction";t.exports=class{constructor(t){this.It=t,this.jr=new c(this.ue.bind(this)),this.$r=null,this.kr=null}get Rr(){return this.$r||this.jr}ce(){return this.kr?this.kr:Array.isArray(this.It.De.owner)?this.It.De.owner[0]:this.It.De.owner}Ae(t,e){this.$r=t,this.kr=e}xe(){this.$r=null,this.kr=null}begin(){return this.Rr.ke(),a()}end(){return this.Rr.Re(),a()}ue(){this.$r||(this.It.Le.hr(this.jr),this.jr=new c(this.ue.bind(this)))}export(){if(this.It.Le.cr.length>0)throw new Error("must not have any queued transactions before exporting");if(0===this.jr.we){throw new Error("No transaction in progress\n\n"+"Hint: A transaction must first be created using begin() or loaded using import().")}return this.jr.Ne(this.It).tx}import(t){return s.ct(f,"Importing",t.hash),this.jr.ve(t,this.It,null,!1)}rollback(){s.ct(f,"Rollback"),this.jr.Fe(this.It.Le.Ge,this.It,"intentional rollback",!1)}async sign(){await this.jr.Be(this.It)}async pay(){await this.jr.Ue(this.It)}get actions(){return this.jr.le.map(t=>({target:this.jr.dt.get(t.target),method:t.method,args:t.args}))}Ie(t,e,r,n,o,i){return this.Rr.Ie(t,e,r,n,o,i,this.ce(),this.It.he,this.It)}St(t,e,r,n,o,i,s,c,a){this.Rr.St(t,e,r,n,o,i,s,c,a,this.It)}async load(t,e={}){if(s.ct(f,"Loading",t),e.re)return o(t,this.It.Ee,this.It.he,e.re);const r=n.parse(t);if(r.innerLocation){const t=await this.load(r.location,e);return o(r.innerLocation,this.It.Ee,this.It.he,t)}return this.Fr(t,e)}async Fr(t,e={}){const r=e.cachedRefs||new Map,o=this.It.he.jt(t);if(o)return o;if(e.sr&&e.sr.has(t))return e.sr.get(t);const s=n.parse(t);if(s.error||s.innerLocation||s.vref||s.tempTxid)throw new Error("Bad location: "+t);const{txid:a,vout:f,vin:h}=s;if(void 0!==h){const t=await this.It.Ee.fetch(a),e=t.inputs[h].prevTxId.toString("hex");return this.load(`${e}_o${t.inputs[h].outputIndex}`,{cachedRefs:r})}const l=await this.It.Te.get(t);if(l){if("string"!=typeof l.type||"object"!=typeof l.state){const t="Hint: Could the state cache be corrupted?";throw new Error(`Cached state is missing a valid type and/or state property\n\n${JSON.stringify(l)}\n\n${t}`)}const e=e=>e.startsWith("_")?`${t.slice(0,64)}${e}`:e,n=t=>r.get(e(t));try{JigControl.vt=!0;const o=l.type.startsWith("_")?t.slice(0,64)+l.type:l.type,s=new(await this.load(o));r.set(t,s);const c=i.Jt(l.state);for(const t of c){const n=e(t);if(r.has(n))continue;const o=await this.load(n,{cachedRefs:r});r.has(n)||r.set(n,o)}return JigControl.g(()=>{const e=i.rt(l.state,{ot:this.It.he.ot,X:i.tt.V(i.tt.Y(n),i.tt.Z())});Object.assign(s,e),s.origin=s.origin||t,s.location=s.location||t}),s}finally{JigControl.vt=!1}}const p=await this.It.Ee.fetch(a),y=u(p,f);if("jig"!==y&&"code"!==y)throw new Error("Not a token: "+t);const g=new c;if(await g.ve(p,this.It,null,!0,f,e.sr),f>0&&f<g.he.length+1)return this.It.he.jt(t)||e.sr.get(t);const d=g.ge.map(t=>g.dt.get(t)),w=new Array(1+g.he.length).concat(d);if(void 0===w[f])throw new Error("not a jig output");return w[f]}}},function(t,e,r){const n=r(4),{NotImplementedError}=r(12);class o{get network(){throw new NotImplementedError}async broadcast(t){throw new NotImplementedError}async fetch(t,e){throw new NotImplementedError}async utxos(t){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.broadcast&&("function"==typeof t.fetch&&("function"==typeof t.utxos&&"string"==typeof t.network))))}}class i{async pay(t){throw new NotImplementedError}async broadcast(t){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&"function"==typeof t.pay)}}class s{info(...t){}debug(...t){}warn(...t){}error(...t){}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&!!t}}class c{async get(t){throw new NotImplementedError}async set(t,e){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.get&&"function"==typeof t.set))}}class a{get script(){throw new NotImplementedError}static[Symbol.hasInstance](t){if("object"!=typeof t||!t)return!1;const e=Object.getOwnPropertyDescriptor(t.constructor.prototype,"script");if(!e)return!1;if("function"!=typeof e.get)return!1;if(e.set)return!1;if(Object.getOwnPropertyNames(t).includes("script"))return!1;const r=t.script,o=n._.O.Uint8Array;return r instanceof Uint8Array||r instanceof o}}class u{get owner(){throw new NotImplementedError}async sign(t,e){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.sign&&!!("string"==typeof t.owner||t.owner instanceof a||Array.isArray(t.owner))))}}t.exports={Blockchain:o,Purse:i,Logger:s,State:c,Lock:a,Owner:u}},function(t,e,r){const{Script:n,Transaction:o}=r(2),{I:i}=r(0),{NotImplementedError}=r(12),{ae:s,Co:c}=r(11),a=r(1),u=r(14),f="BlockchainApi";class h{constructor(t={}){this.network=_(t.network),this.$o=function(t){switch(typeof t.api){case"string":{const e=w[t.api];if(!e)throw new Error("Unknown blockchain API: "+t.api);return new e(t)}case"object":if(!t.api)throw new Error("Invalid blockchain API: "+t.api);return t.api;case"undefined":return"stn"===t.network?new d(t):new y(t);default:throw new Error("Invalid blockchain API: "+t.api)}}(t),this.cache=function(t,e){if(t&&t instanceof h&&t.network===e)return t.cache;return new l}(t.lastBlockchain,this.network),this.bsvNetwork=i(this.network),this.Mr=new Map}get api(){return"string"==typeof this.$o.api?this.$o.api:"custom"}async broadcast(t){if(await s(t,this),t.lock&&t.lock(),0===t.inputs.length)throw new Error("tx has no inputs");if(0===t.outputs.length)throw new Error("tx has no outputs");if(t.getFee()<t.toBuffer().length*o.FEE_PER_KB/1e3)throw new Error("tx fee too low");if(!0!==t.verify())throw new Error(t.verify());if(!0!==t.isFullySigned())throw new Error("tx not fully signed");if(t.inputs.some((e,r)=>!t.isValidSignature({inputIndex:r})))throw new Error("tx signature not valid");t.time=Date.now(),t.confirmations=0,t.outputs.forEach(t=>{t.spentTxId=null,t.spentIndex=null,t.spentHeight=null}),await this.$o.broadcast(t),this.cache.Ur(t)}async fetch(t,e=!1){const r=this.cache.Nr(t);if(!e&&r)return r;const n=this.Mr.get(t);if(n)return new Promise((t,e)=>n.push({resolve:t,reject:e}));this.Mr.set(t,[]);try{const e=await this.$o.fetch(t,!0);if(r)for(let t=0;t<e.outputs.length;t++)e.outputs[t].spentTxId=e.outputs[t].spentTxId||r.outputs[t].spentTxId,e.outputs[t].spentIndex=e.outputs[t].spentIndex||r.outputs[t].spentIndex,e.outputs[t].spentHeight=e.outputs[t].spentHeight||r.outputs[t].spentHeight;return this.cache.Cr(e),this.Mr.get(t).forEach(t=>t.resolve(e)),e}catch(e){throw this.Mr.get(t).forEach(t=>t.reject(e)),e}finally{this.Mr.delete(t)}}async utxos(t){const e=t instanceof n?t:n.fromAddress(t),r=c(e),o=this.Mr.get(r);if(o)return new Promise((t,e)=>o.push({resolve:t,reject:e}));this.Mr.set(r,[]);try{const n=await this.$o.utxos(e);if(!Array.isArray(n))throw new Error(`Received invalid utxos for ${t}\n\n: Type: ${typeof n}\n\nNetwork: ${this.network}`);const o=this.Br(n),i=this.cache.Dr(o,e);return this.Mr.get(r).forEach(t=>t.resolve(i)),i}catch(t){throw this.Mr.get(r).forEach(e=>e.reject(t)),t}finally{this.Mr.delete(r)}}Br(t){const e=new Set;return t.filter(t=>{const r=`${t.txid}_o${t.vout}`;return e.has(r)?(a.at(f,"Duplicate utxo returned from server:",r),!1):(e.add(r),!0)})}}class l{constructor(){this.Lr=new Map,this.ur=[],this.size=1e4,this.expiration=6e5,this.Gr=1e4}clear(){this.Lr=new Map,this.ur=[]}Nr(t){const e=this.Lr.get(t);if(e)return Date.now()-e.Jr>this.expiration?void this.Lr.delete(t):(this.Lr.delete(t),this.Lr.set(t,e),e)}Cr(t){if(t.Jr=Date.now(),this.Lr.set(t.hash,t),this.Lr.size>this.size){const t=this.Lr.keys().next().value;this.Lr.delete(t)}}Ur(t){this.Cr(t);const e=Date.now();this.ur=this.ur.filter(t=>e-t.time<this.Gr),this.ur.push(t),t.inputs.forEach((e,r)=>{const n=this.Lr.get(e.prevTxId.toString("hex"));n&&(n.outputs[e.outputIndex].spentTxId=t.hash,n.outputs[e.outputIndex].spentIndex=r,n.outputs[e.outputIndex].spentHeight=-1)})}Dr(t,e){const r=Date.now();return this.ur=this.ur.filter(t=>r-t.time<this.Gr),this.ur.forEach(r=>{r.outputs.forEach((n,o)=>{n.script.equals(e)&&!t.some(t=>t.txid===r.hash&&t.vout===o)&&t.push({txid:r.hash,vout:o,script:n.script,satoshis:n.satoshis})})}),this.ur.forEach(e=>{t=t.filter(t=>!e.inputs.some(e=>((t,e)=>t.prevTxId.toString("hex")===e.txid&&t.outputIndex===e.vout)(e,t)))}),t}}class p{constructor(t={}){this.timeout=function(t){switch(typeof t){case"number":if(Number.isNaN(t)||t<0)throw new Error("Invalid timeout: "+t);return t;case"undefined":return 1e4;default:throw new Error("Invalid timeout: "+t)}}(t.timeout),this.network=t.network,this.apiKey=t.apiKey}async broadcast(t){await u.Hr(this.Wr(this.network),this.Kr(t),this.timeout)}async fetch(t,e=!1){const r=await u.Nr(this.Vr(this.network,t),this.timeout);return this.zr(r)}async utxos(t){const e=await u.Nr(this.qr(this.network,t),this.timeout);return this.Yr(e,t)}get api(){return"custom"}Wr(t){throw new NotImplementedError}Kr(t){throw new NotImplementedError}Vr(t,e){throw new NotImplementedError}zr(t){throw new NotImplementedError}qr(t,e){throw new NotImplementedError}Yr(t,e){throw new NotImplementedError}}class y extends p{constructor(t){if(t.network=_(t.network),"main"!==t.network&&"test"!==t.network)throw new Error("Run Connect API only supports mainnet and testnet");super(t)}get api(){return"run"}Wr(t){return`https://api.run.network/v1/${t}/tx`}Kr(t){return{rawtx:t.toBuffer().toString("hex")}}Vr(t,e){return`https://api.run.network/v1/${t}/tx/${e}`}zr(t){return b(t)}qr(t,e){return`https://api.run.network/v1/${t}/utxos/${c(e)}`}Yr(t,e){return"string"==typeof t?JSON.parse(t):t}}class g extends p{constructor(t){if(t.network=_(t.network),"main"!==t.network)throw new Error("MatterCloud API only supports mainnet");super(t)}get api(){return"mattercloud"}Wr(t){return`https://api.mattercloud.net/api/v3/${t}/tx/send${this.Qr}`}Kr(t){return{rawtx:t.toBuffer().toString("hex")}}Vr(t,e){return`https://api.mattercloud.net/api/v3/${t}/tx/${e}${this.Qr}`}zr(t){const e=b(t);return e.confirmations=e.confirmations||0,e}qr(t,e){return`https://api.mattercloud.net/api/v3/${t}/scripthash/${c(e)}/utxo${this.Qr}`}Yr(t,e){return t.map(t=>Object.assign({},t,{script:e}))}get Qr(){return this.apiKey?"?api_key="+this.apiKey:""}}class d extends p{constructor(t){if(t.network=_(t.network),"main"!==t.network&&"test"!==t.network&&"stn"!==t.network)throw new Error("WhatsOnChain API only supports mainnet, testnet, and STN");super(t)}get api(){return"whatsonchain"}Wr(t){return`https://api.whatsonchain.com/v1/bsv/${t}/tx/raw`}Kr(t){return{txhex:t.toBuffer().toString("hex")}}qr(t,e){return`https://api.whatsonchain.com/v1/bsv/${t}/script/${c(e)}/unspent`}Yr(t,e){return t.map(t=>({txid:t.tx_hash,vout:t.tx_pos,satoshis:t.value,script:e}))}async fetch(t,e=!1){const r=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/hash/${t}`,n=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/${t}/hex`,[o,i]=await Promise.all([u.Nr(r,this.timeout),u.Nr(n,this.timeout)]);return o.confirmations=o.confirmations||0,o.hex=i,b(o)}async utxos(t){return"stn"===this.network?(a.at(f,"Utxos are not available on STN"),[]):super.utxos(t)}}const w={run:y,mattercloud:g,bitindex:g,whatsonchain:d};function b(t){if("object"!=typeof t)throw new Error("JSON returned is invalid or not an object: "+t);const e=new o(t.hex||t.rawtx);return e.time=1e3*t.time||Date.now(),t.blockhash&&t.blockhash.length&&(e.blockhash=t.blockhash),t.blocktime&&(e.blocktime=t.blocktime),t.blockheight&&(e.blockheight=t.blockheight),void 0!==t.confirmations&&(e.confirmations=t.confirmations),t.vout&&t.vout.forEach((t,r)=>{void 0!==t.spentTxId&&(e.outputs[r].spentTxId=t.spentTxId),void 0!==t.spentIndex&&(e.outputs[r].spentIndex=t.spentIndex),void 0!==t.spentHeight&&(e.outputs[r].spentHeight=t.spentHeight)}),e}function _(t){if(void 0===t)return"main";if("main"===t||"test"===t||"stn"===t)return t;throw new Error("Unsupported network: "+t)}h.Cache=l,h.RunConnect=y,h.MatterCloud=g,h.WhatsOnChain=d,t.exports=h},function(t,e,r){const{PrivateKey:n,Script:o}=r(2),{I:i,F:s}=r(0);t.exports=class{constructor(t={}){if(this.blockchain=t.blockchain,void 0!==t.privkey&&"string"!=typeof t.privkey&&!(t.privkey instanceof n))throw new Error("Invalid private key: "+s(t.privkey));const e=this.blockchain&&i(this.blockchain.network);if(e&&t.privkey&&t.privkey instanceof n&&t.privkey.network.name!==e)throw new Error("Private key network mismatch");try{this.bsvPrivateKey=new n(t.privkey,e)}catch(e){throw new Error(`Invalid private key: ${s(t.privkey)}\n\n${e}`)}if(t.privkey&&this.bsvPrivateKey.toString()!==t.privkey.toString())throw new Error("Invalid private key: "+s(t.privkey));this.bsvPublicKey=this.bsvPrivateKey.publicKey,this.bsvAddress=this.bsvPublicKey.toAddress(),this.privkey=this.bsvPrivateKey.toString(),this.pubkey=this.bsvPublicKey.toString(),this.address=this.bsvAddress.toString(),this.owner=this.address}async sign(t,e){for(let r=0;r<t.inputs.length;r++){const n=e[r]&&e[r].constructor.name;if("StandardLock"===n&&e[r].address===this.address)if(t.signature){const e=t.signature(r,this.bsvPrivateKey).toString("hex"),n=o.fromASM(`${e} ${this.pubkey}`);t.inputs[r].setScript(n)}else t.sign(this.bsvPrivateKey);if("GroupLock"===n&&e[r].pubkeys.includes(this.pubkey)&&t.inputs[r].script.chunks.length<=e[r].m){const e=t.signature(r,this.bsvPrivateKey).toString("hex");let n=null;n=t.inputs[r].script.toBuffer().length?o.fromASM(`${t.inputs[r].script.toASM()} ${e}`):o.fromASM("OP_0 "+e),t.inputs[r].setScript(n)}}return t}}},function(t,e,r){const{PrivateKey:n,Script:o}=r(2),{I:i,F:s}=r(0),{Kt:c}=r(8),a=r(1),u="LocalPurse";function f(t){switch(typeof t){case"number":if(!Number.isInteger(t))throw new Error("splits must be an integer: "+t);if(t<=0)throw new Error("splits must be at least 1: "+t);return t;case"undefined":return 10;default:throw new Error("Invalid splits: "+t)}}function h(t){switch(typeof t){case"number":if(!Number.isFinite(t))throw new Error("feePerKb must be finite: "+t);if(t<0)throw new Error("feePerKb must be non-negative: "+t);return t;case"undefined":return 500;default:throw new Error("Invalid feePerKb: "+t)}}t.exports=class{constructor(t={}){this.blockchain=function(t){switch(typeof t){case"undefined":throw new Error("blockchain is required");case"object":if(t&&t.network)return t}throw new Error("Invalid blockchain: "+s(t))}(t.blockchain),this.Zr=f(t.splits),this.Xr=h(t.feePerKb),this.bsvPrivateKey=new n(t.privkey,i(this.blockchain.network)),this.privkey=this.bsvPrivateKey.toString(),this.bsvAddress=this.bsvPrivateKey.toAddress(),this.address=this.bsvAddress.toString(),this.script=o.fromAddress(this.bsvAddress)}get splits(){return this.Zr}set splits(t){this.Zr=f(t)}get feePerKb(){return this.Xr}set feePerKb(t){this.Xr=h(t)}async pay(t){a.ct(u,"Paying for",t.hash);let e=await this.blockchain.utxos(this.script);e=function(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}(e),t.feePerKb(this.feePerKb);const r=this.feePerKb/1e3,n=Math.max(500,t._estimateFee()+t._getOutputAmount());if(!n)return t;if(!e.length){const t=`Hint: Have you funded the purse address ${this.address}?`;throw new Error("Not enough funds\n\n"+t)}let o=n,i=0;const s=t._getInputAmount(),f=t._getOutputAmount();let h=t._getInputAmount(),l=0,p=0;for(const n of e){const s=await this.blockchain.fetch(n.txid);if("other"!==c(s,n.vout))continue;t.from(n),i+=n.satoshis,h+=n.satoshis,l+=1,o+=Math.floor(150*r);const a=this.splits-e.length+l-p;for(let t=0;t<a;t++)o+=Math.floor(40*r),o+=546,p+=1;if(h>o+50)break}if(h<=o+50){const t=`Required ${o+50} satoshis, ${h} available in ${this.address}`;throw new Error("Not enough funds\n\n"+t)}p<1&&(p=1);const y=o-546*p,g=Math.floor((i-y)/p);for(let e=0;e<p;e++)e===p-1?t.change(this.bsvAddress):t.to(this.bsvAddress,g);const d=t._getInputAmount()-s-(t._getOutputAmount()-f);return a.ft(u,"Paid about",d+50,"satoshis,",t.getFee(),"in fees"),t.sign(this.bsvPrivateKey),t}async balance(){return(await this.utxos()).reduce((t,e)=>t+e.satoshis,0)}async utxos(){const t=await this.blockchain.utxos(this.script),e=await Promise.all(t.map(t=>this.blockchain.fetch(t.txid)));return t.filter((t,r)=>"other"===c(e[r],t.vout))}}},function(t,e,r){const{L:n,F:o}=r(0),i=r(2),{Script:s}=i,c=r(1);t.exports=class{constructor(t){this.owner=n(t),this.script=new s(i.deps.Buffer.from(this.owner.script))}async sign(t,e){return c.at("Viewer","Viewer cannot sign ",o(this.owner)),t}}},function(t,e,r){const n=r(2),{Address:o,Transaction:i,Script:s}=n,c=r(1),{ae:a,Co:u}=r(11),{sha256:f}=n.crypto.Hash,h="Mockchain";t.exports=class{constructor(){this.network="mock",this.tn=-1,this.Lr=new Map,this.en=new Map,this.rn=new Map,this.nn=new Set,this.sn=new Set,this.cn=25}async broadcast(t){if(c.ft(h,"Broadcast",t.hash),await a(t,this),t.lock&&t.lock(),0===t.inputs.length)throw new Error("tx has no inputs");if(0===t.outputs.length)throw new Error("tx has no outputs");if(t.getFee()<t.toBuffer().length*i.FEE_PER_KB/1e3)throw new Error("tx fee too low");if(!0!==t.verify())throw new Error(t.verify());const e=new Set;if(t.inputs.forEach((t,r)=>{const n=`${t.prevTxId.toString("hex")}_o${t.outputIndex}`;if(!this.en.has(n))throw new Error(this.sn.has(n)?"txn-mempool-conflict":"Missing inputs");if(e.has(n))throw new Error("already spent input "+r);e.add(n)}),!0!==t.isFullySigned())throw new Error("tx not fully signed");if(t.inputs.some((e,r)=>!t.isValidSignature({inputIndex:r})))throw new Error("tx signature not valid");if(t.an=Math.max(...t.inputs.map(t=>this.Lr.get(t.prevTxId.toString("hex")).an+1)),t.an>this.cn){throw new Error("too-long-mempool-chain\n\n"+"Hint: Use run.blockchain.block() to produce blocks on the mockchain.")}t.inputs.forEach((t,e)=>{const r=t.prevTxId.toString("hex"),n=`${r}_o${t.outputIndex}`,o=this.Lr.get(r).outputs[t.outputIndex].script,i=f(o.toBuffer()).reverse().toString("hex");this.en.delete(n),this.rn.get(i).delete(n)}),t.time=t.time||Date.now(),t.blockheight=-1,t.confirmations=0,this.Lr.set(t.hash,t),this.nn.add(t),t.outputs.forEach(t=>{t.spentTxId=null,t.spentIndex=null,t.spentHeight=null}),t.inputs.forEach((e,r)=>{const n=this.Lr.get(e.prevTxId.toString("hex")).outputs[e.outputIndex];n.spentTxId=t.hash,n.spentIndex=r,n.spentHeight=-1,this.sn.add(`${e.prevTxId.toString("hex")}_o${e.outputIndex}`)}),t.outputs.forEach((e,r)=>{const n={txid:t.hash,vout:r,script:e.script,satoshis:e.satoshis},o=`${t.hash}_o${r}`;this.en.set(o,n);const i=f(e.script.toBuffer()).reverse().toString("hex"),s=this.rn.get(i)||new Set;s.add(o),this.rn.set(i,s)})}async fetch(t){c.ft(h,"Fetch",t);const e=this.Lr.get(t);if(!e)throw new Error("tx not found: "+t);return e}async utxos(t){c.ft(h,"Utxos",t.toString());const e=t instanceof s?t:s.fromAddress(t),r=this.rn.get(u(e));return r?Array.from(r).map(t=>this.en.get(t)):[]}fund(t,e){const r=Math.random().toString(),n=(new i).addData(r).to(new o(t,"testnet"),e).lock();n.time=Date.now(),n.confirmations=0,n.blockheight=-1,n.an=0,this.Lr.set(n.hash,n),this.nn.add(n);const c=n.outputs[1],a={txid:n.hash,vout:1,script:c.script,satoshis:c.satoshis},u=n.hash+"_o1";this.en.set(u,a);const h=s.fromAddress(t),l=f(h.toBuffer()).reverse().toString("hex"),p=this.rn.get(l)||new Set;return p.add(u),this.rn.set(l,p),n.hash}block(){this.tn+=1;for(const t of this.nn){t.blockheight=this.tn,t.an=0;for(const e of t.inputs){this.Lr.get(e.prevTxId.toString("hex")).outputs[e.outputIndex].spentHeight=this.tn}}this.nn=new Set,this.sn.clear()}}},function(t,e,r){const n=r(2),o=r(14),{F:i}=r(0);t.exports=class{constructor(t){let e=null;try{e=new n.HDPublicKey(t)}catch(e){throw new Error("Invalid API key: "+i(t))}this.network="mainnet"===e.network.name?"main":"test",this.apiKey=t,this.timeout=2e3}async pay(t){const e={tx:t.toJSON(),key:this.apiKey},r=`https://api.run.network/v1/${this.network}/pay`,i=await o.Hr(r,e,this.timeout);return new n.Transaction(i)}}},function(t,e,r){const n=r(6);class o{constructor(t={}){this.cache=new Map,this.un=0;const e=void 0===t.maxSizeMB?10:t.maxSizeMB;this.fn=Math.floor(1e3*e*1e3)}async get(t){n.parse(t);const e=this.cache.has(t),r=this.cache.get(t);if(e)return this.set(t,r),r}async set(t,e){n.parse(t);const r=this.cache.has(t),i=this.cache.get(t);if(r){if(!function t(e,r){if(typeof e!=typeof r)return!1;if("object"!=typeof e||!e||!r)return e===r;const n=Array.from(Object.keys(e)),o=Array.from(Object.keys(r));return n.length===o.length&&!n.some(n=>!t(e[n],r[n]))}(e,i)){throw new Error(`Attempt to set different states for the same location: ${t}\n\n${"This is an internal Run bug. Please report it to the library developers."}`)}this.cache.delete(t)}if(this.cache.set(t,e),!r)for(this.un+=o.hn(e);this.un>this.fn;){const t=this.cache.keys().next().value,e=this.cache.get(t);this.cache.delete(t),this.un-=o.hn(e)}}static hn(t){switch(typeof t){case"boolean":return 5;case"number":return 9;case"string":return 2*t.length+1;case"object":{if(!t)return 5;const e=Object.keys(t);let r=1+4*e.length;return e.forEach(e=>{r+=o.hn(e),r+=o.hn(t[e])}),r}default:return 5}}}t.exports=o},function(t,e,r){const asm=r(21),hex=r(15);class GroupLock{constructor(t,e){this.pubkeys=t,this.m=void 0===e?this.pubkeys.length:e}get script(){if(!Array.isArray(this.pubkeys))throw new Error("pubkeys not an array");if(this.pubkeys.length<1)throw new Error("pubkeys must have at least one entry");if(this.pubkeys.length>16)throw new Error("No more than 16 pubkeys allowed");const t=new Set;for(const e of this.pubkeys)t.add(e);if(t.size!==this.pubkeys.length)throw new Error("pubkeys contains duplicates");if(this.pubkeys.forEach(t=>hex(t)),"number"!=typeof this.m||!Number.isInteger(this.m)||this.m<1)throw new Error("m must be a non-negative integer");if(this.m>this.pubkeys.length)throw new Error("m must be <= the number of pubkeys");return asm(`OP_${this.m} ${this.pubkeys.join(" ")} OP_${this.pubkeys.length} OP_CHECKMULTISIG`)}}GroupLock.deps={asm,hex},GroupLock.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o4",GroupLock.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o4",GroupLock.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",GroupLock.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o4",GroupLock.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o4",GroupLock.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",t.exports=GroupLock},function(t,e,r){const{Jig}=r(3),expect=r(22);class Token extends Jig{init(t,e,r){if(expect(this.constructor).not.toBe(Token,"Token must be extended"),void 0!==e)return expect(e).toBeObject("bad token type"),expect(e.constructor).toBe(this.constructor,"bad token class"),this.ln(t),e.pn(t),void(this.amount=t);if(void 0!==r){if(expect(r).toBeArray(),expect(r.length).toBeGreaterThanOrEqualTo(2,"must combine at least two tokens"),r.some(t=>t.constructor!==this.constructor))throw new Error("cannot combine different token classes");const t=t=>r.reduce((e,r)=>r===t?e+1:e,0);if(r.some(e=>t(e)>1))throw new Error("cannot combine duplicate tokens");return this.amount=0,r.forEach(t=>{this.amount+=t.amount,t.yn()}),void this.ln(this.amount)}this.ln(t),expect(this.owner).toBe(this.constructor.owner,`Only ${this.constructor.name}'s owner may mint`),this.amount=t,this.gn(t,caller)}send(t,e){if(e=void 0===e?this.amount:e,this.ln(e),expect(e).toBeLessThanOrEqualTo(this.amount,"not enough funds"),this.amount===e)return this.owner=t,null;const r=new this.constructor(this.amount-e,this);return this.owner=t,r}get value(){let t=this.amount;for(let e=0;e<this.constructor.decimals;e++)t/=10;return t}static combine(...t){return new this(void 0,void 0,t)}yn(){this.amount=0,this.owner="029d11c250cc84a6ffbaf84fc28da82fc4deee214021bed2dcaa22d5193d22e273"}pn(t){this.amount-=t}ln(t){expect(t).toBeNumber("amount is not a number"),expect(t).toBeInteger("amount must be an integer"),expect(t).toBeGreaterThan(0,"amount must be positive"),expect(t).toBeLessThanOrEqualTo(Number.MAX_SAFE_INTEGER,"amount too large")}gn(t,e){}}Token.decimals=0,Token.deps={expect},Token.originMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o7",Token.locationMainnet="3317246b76b5944fa4a37e3d383d9a8c9118acf95d873a5cfc3f24cd0f52c297_o7",Token.ownerMainnet="14zsAvs6LMnmtopdmf1RRiivZu9rYLeVzo",Token.originTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o7",Token.locationTestnet="3d2db827cd8bbd379c4d2984bd4878b9d1703cad809a85bb3fcab752ff36dc59_o7",Token.ownerTestnet="mghkHBc9R4zRgZhPx5rDfoSgXPdSRMeEih",t.exports=Token}])}));